import{i as Vn,j as qn,l as A}from"./chunk-PBA57O2B.js";import{b as On,c as Pn,d as Dn,e as Xn,f as Hn,g as Yn,j as Fn,k as He}from"./chunk-TNPE2B44.js";import{Aa as Tn,Db as Bn,Eb as Ln,Ib as Oe,Jb as V,Mb as In,Nb as An,Ob as Pe,Pb as De,Va as Nt,W as Sn,Wa as wt,ab as Mn,da as Ie,ea as kn,fa as En,hb as Nn,lb as Jt,na as ut,oa as ct,ob as $t,pb as ft,rb as $n,tb as Re,tc as Rn,va as zn,wa as Ae,yb as Bt,zb as Zt,zc as Xe}from"./chunk-MFMNMFCO.js";var _o=["container"];function vo(e,n){e&1&&Bn(0)}function wo(e,n){if(e&1){let t=Ln();Bt(0,"div",6),Oe("mousedown",function(i){ut(t);let o=V().index,s=V();return ct(s.onGutterMouseDown(i,o))})("touchstart",function(i){ut(t);let o=V().index,s=V();return ct(s.onGutterTouchStart(i,o))})("touchmove",function(i){ut(t);let o=V(2);return ct(o.onGutterTouchMove(i))})("touchend",function(i){ut(t);let o=V().index,s=V();return ct(s.onGutterTouchEnd(i,o))}),Bt(1,"div",7),Oe("keyup",function(i){ut(t);let o=V(2);return ct(o.onGutterKeyUp(i))})("keydown",function(i){ut(t);let o=V().index,s=V();return ct(s.onGutterKeyDown(i,o))}),Zt()()}if(e&2){let t=V(2);$t("data-p-gutter-resizing",!1)("data-pc-section","gutter"),Nt(),ft("ngStyle",t.gutterStyle()),$t("aria-orientation",t.layout)("aria-valuenow",t.prevSize)("data-pc-section","gutterhandle")}}function bo(e,n){if(e&1&&(Bt(0,"div",3),Jt(1,vo,1,0,"ng-container",4),Zt(),Jt(2,wo,2,6,"div",5)),e&2){let t=n.$implicit,r=n.index,i=V();Re(i.panelStyleClass),ft("ngClass",i.panelContainerClass())("ngStyle",i.panelStyle),$t("data-pc-name","splitter")("data-pc-section","root"),Nt(),ft("ngTemplateOutlet",t),Nt(),ft("ngIf",r!==i.panels.length-1)}}var Il=(()=>{class e{document;platformId;renderer;cd;el;styleClass;panelStyleClass;style;panelStyle;stateStorage="session";stateKey=null;layout="horizontal";gutterSize=4;step=5;minSizes=[];get panelSizes(){return this._panelSizes}set panelSizes(t){if(this._panelSizes=t,this.el&&this.el.nativeElement&&this.panels.length>0){let r=[...this.el.nativeElement.children[0].children].filter(o=>A.hasClass(o,"p-splitter-panel")),i=[];this.panels.map((o,s)=>{let u=(this.panelSizes.length-1>=s?this.panelSizes[s]:null)??100/this.panels.length;i[s]=u,r[s].style.flexBasis="calc("+u+"% - "+(this.panels.length-1)*this.gutterSize+"px)"})}}onResizeEnd=new Ae;onResizeStart=new Ae;templates;containerViewChild;nested=!1;panels=[];dragging=!1;mouseMoveListener;mouseUpListener;touchMoveListener;touchEndListener;size;gutterElement;startPos;prevPanelElement;nextPanelElement;nextPanelSize;prevPanelSize;_panelSizes=[];prevPanelIndex;timer;prevSize;window;constructor(t,r,i,o,s){this.document=t,this.platformId=r,this.renderer=i,this.cd=o,this.el=s,this.window=this.document.defaultView}ngOnInit(){this.nested=this.isNested()}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"panel":this.panels.push(t.template);break;default:this.panels.push(t.template);break}})}ngAfterViewInit(){if(He(this.platformId)&&this.panels&&this.panels.length){let t=!1;if(this.isStateful()&&(t=this.restoreState()),!t){let r=[...this.el.nativeElement.children[0].children].filter(o=>A.hasClass(o,"p-splitter-panel")),i=[];this.panels.map((o,s)=>{let u=(this.panelSizes.length-1>=s?this.panelSizes[s]:null)||100/this.panels.length;i[s]=u,r[s].style.flexBasis="calc("+u+"% - "+(this.panels.length-1)*this.gutterSize+"px)"}),this._panelSizes=i,this.prevSize=parseFloat(i[0]).toFixed(4)}}}resizeStart(t,r,i){this.gutterElement=t.currentTarget||t.target.parentElement,this.size=this.horizontal()?A.getWidth(this.containerViewChild.nativeElement):A.getHeight(this.containerViewChild.nativeElement),i||(this.dragging=!0,this.startPos=this.horizontal()?t instanceof MouseEvent?t.pageX:t.changedTouches[0].pageX:t instanceof MouseEvent?t.pageY:t.changedTouches[0].pageY),this.prevPanelElement=this.gutterElement.previousElementSibling,this.nextPanelElement=this.gutterElement.nextElementSibling,i?(this.prevPanelSize=this.horizontal()?A.getOuterWidth(this.prevPanelElement,!0):A.getOuterHeight(this.prevPanelElement,!0),this.nextPanelSize=this.horizontal()?A.getOuterWidth(this.nextPanelElement,!0):A.getOuterHeight(this.nextPanelElement,!0)):(this.prevPanelSize=100*(this.horizontal()?A.getOuterWidth(this.prevPanelElement,!0):A.getOuterHeight(this.prevPanelElement,!0))/this.size,this.nextPanelSize=100*(this.horizontal()?A.getOuterWidth(this.nextPanelElement,!0):A.getOuterHeight(this.nextPanelElement,!0))/this.size),this.prevPanelIndex=r,A.addClass(this.gutterElement,"p-splitter-gutter-resizing"),this.gutterElement.setAttribute("data-p-gutter-resizing","true"),A.addClass(this.containerViewChild.nativeElement,"p-splitter-resizing"),this.containerViewChild.nativeElement.setAttribute("data-p-resizing","true"),this.onResizeStart.emit({originalEvent:t,sizes:this._panelSizes})}onResize(t,r,i){let o,s,a;i?this.horizontal()?(s=100*(this.prevPanelSize+r)/this.size,a=100*(this.nextPanelSize-r)/this.size):(s=100*(this.prevPanelSize-r)/this.size,a=100*(this.nextPanelSize+r)/this.size):(this.horizontal()?o=t.pageX*100/this.size-this.startPos*100/this.size:o=t.pageY*100/this.size-this.startPos*100/this.size,s=this.prevPanelSize+o,a=this.nextPanelSize-o),this.prevSize=parseFloat(s).toFixed(4),this.validateResize(s,a)&&(this.prevPanelElement.style.flexBasis="calc("+s+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.nextPanelElement.style.flexBasis="calc("+a+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this._panelSizes[this.prevPanelIndex]=s,this._panelSizes[this.prevPanelIndex+1]=a)}resizeEnd(t){this.isStateful()&&this.saveState(),this.onResizeEnd.emit({originalEvent:t,sizes:this._panelSizes}),A.removeClass(this.gutterElement,"p-splitter-gutter-resizing"),A.removeClass(this.containerViewChild.nativeElement,"p-splitter-resizing"),this.clear()}onGutterMouseDown(t,r){this.resizeStart(t,r),this.bindMouseListeners()}onGutterTouchStart(t,r){t.cancelable&&(this.resizeStart(t,r),this.bindTouchListeners(),t.preventDefault())}onGutterTouchMove(t){this.onResize(t),t.preventDefault()}onGutterTouchEnd(t){this.resizeEnd(t),this.unbindTouchListeners(),t.cancelable&&t.preventDefault()}repeat(t,r,i){this.resizeStart(t,r,!0),this.onResize(t,i,!0)}setTimer(t,r,i){this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(t,r,i)},40)}clearTimer(){this.timer&&clearTimeout(this.timer)}onGutterKeyUp(t){this.clearTimer(),this.resizeEnd(t)}onGutterKeyDown(t,r){switch(t.code){case"ArrowLeft":{this.layout==="horizontal"&&this.setTimer(t,r,this.step*-1),t.preventDefault();break}case"ArrowRight":{this.layout==="horizontal"&&this.setTimer(t,r,this.step),t.preventDefault();break}case"ArrowDown":{this.layout==="vertical"&&this.setTimer(t,r,this.step*-1),t.preventDefault();break}case"ArrowUp":{this.layout==="vertical"&&this.setTimer(t,r,this.step),t.preventDefault();break}default:break}}validateResize(t,r){let i=this.prevPanelIndex;if(this.minSizes.length>i&&this.minSizes[i]&&this.minSizes[i]>t)return!1;let o=this.prevPanelIndex+1;return!(this.minSizes.length>o&&this.minSizes[o]&&this.minSizes[o]>r)}bindMouseListeners(){this.mouseMoveListener||(this.mouseMoveListener=this.renderer.listen(this.document,"mousemove",t=>{this.onResize(t)})),this.mouseUpListener||(this.mouseUpListener=this.renderer.listen(this.document,"mouseup",t=>{this.resizeEnd(t),this.unbindMouseListeners()}))}bindTouchListeners(){this.touchMoveListener||(this.touchMoveListener=this.renderer.listen(this.document,"touchmove",t=>{this.onResize(t.changedTouches[0])})),this.touchEndListener||(this.touchEndListener=this.renderer.listen(this.document,"touchend",t=>{this.resizeEnd(t),this.unbindTouchListeners()}))}unbindMouseListeners(){this.mouseMoveListener&&(this.mouseMoveListener(),this.mouseMoveListener=null),this.mouseUpListener&&(this.mouseUpListener(),this.mouseUpListener=null)}unbindTouchListeners(){this.touchMoveListener&&(this.touchMoveListener(),this.touchMoveListener=null),this.touchEndListener&&(this.touchEndListener(),this.touchEndListener=null)}clear(){this.dragging=!1,this.size=null,this.startPos=null,this.prevPanelElement=null,this.nextPanelElement=null,this.prevPanelSize=null,this.nextPanelSize=null,this.gutterElement=null,this.prevPanelIndex=null}isNested(){if(this.el.nativeElement){let t=this.el.nativeElement.parentElement;for(;t&&!A.hasClass(t,"p-splitter");)t=t.parentElement;return t!==null}else return!1}isStateful(){return this.stateKey!=null}getStorage(){if(He(this.platformId))switch(this.stateStorage){case"local":return this.window.localStorage;case"session":return this.window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}else throw new Error("Storage is not a available by default on the server.")}saveState(){this.getStorage().setItem(this.stateKey,JSON.stringify(this._panelSizes))}restoreState(){let r=this.getStorage().getItem(this.stateKey);return r?(this._panelSizes=JSON.parse(r),[...this.containerViewChild.nativeElement.children].filter(o=>A.hasClass(o,"p-splitter-panel")).forEach((o,s)=>{o.style.flexBasis="calc("+this._panelSizes[s]+"% - "+(this.panels.length-1)*this.gutterSize+"px)"}),!0):!1}containerClass(){return{"p-splitter p-component":!0,"p-splitter-horizontal":this.layout==="horizontal","p-splitter-vertical":this.layout==="vertical"}}panelContainerClass(){return{"p-splitter-panel":!0,"p-splitter-panel-nested":!0}}gutterStyle(){return this.horizontal()?{width:this.gutterSize+"px"}:{height:this.gutterSize+"px"}}horizontal(){return this.layout==="horizontal"}static \u0275fac=function(r){return new(r||e)(wt(On),wt(Tn),wt(Mn),wt(Rn),wt(zn))};static \u0275cmp=kn({type:e,selectors:[["p-splitter"]],contentQueries:function(r,i,o){if(r&1&&In(o,Vn,4),r&2){let s;Pe(s=De())&&(i.templates=s)}},viewQuery:function(r,i){if(r&1&&An(_o,5),r&2){let o;Pe(o=De())&&(i.containerViewChild=o.first)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(r,i){r&2&&$n("p-splitter-panel-nested",i.nested)},inputs:{styleClass:"styleClass",panelStyleClass:"panelStyleClass",style:"style",panelStyle:"panelStyle",stateStorage:"stateStorage",stateKey:"stateKey",layout:"layout",gutterSize:[Ie.HasDecoratorInputTransform,"gutterSize","gutterSize",Xe],step:[Ie.HasDecoratorInputTransform,"step","step",Xe],minSizes:"minSizes",panelSizes:"panelSizes"},outputs:{onResizeEnd:"onResizeEnd",onResizeStart:"onResizeStart"},features:[Nn],decls:3,vars:8,consts:[["container",""],[3,"ngClass","ngStyle"],["ngFor","",3,"ngForOf"],["tabindex","-1",3,"ngClass","ngStyle"],[4,"ngTemplateOutlet"],["class","p-splitter-gutter","role","separator","tabindex","-1",3,"mousedown","touchstart","touchmove","touchend",4,"ngIf"],["role","separator","tabindex","-1",1,"p-splitter-gutter",3,"mousedown","touchstart","touchmove","touchend"],["tabindex","0",1,"p-splitter-gutter-handle",3,"keyup","keydown","ngStyle"]],template:function(r,i){r&1&&(Bt(0,"div",1,0),Jt(2,bo,3,8,"ng-template",2),Zt()),r&2&&(Re(i.styleClass),ft("ngClass",i.containerClass())("ngStyle",i.style),$t("data-pc-name","splitter")("data-p-gutter-resizing",!1)("data-pc-section","root"),Nt(2),ft("ngForOf",i.panels))},dependencies:[Pn,Dn,Xn,Yn,Hn],styles:[`@layer primeng{.p-splitter{display:flex;flex-wrap:nowrap}.p-splitter-vertical{flex-direction:column}.p-splitter-panel{overflow:hidden;flex-grow:1}.p-splitter-panel-nested{display:flex;min-width:0}.p-splitter-panel p-splitter{flex-grow:1}.p-splitter-panel .p-splitter{flex-grow:1;border:0 none}.p-splitter-gutter{flex-grow:0;flex-shrink:0;display:flex;align-items:center;justify-content:center;cursor:col-resize}.p-splitter-horizontal.p-splitter-resizing{cursor:col-resize;-webkit-user-select:none;user-select:none}.p-splitter-horizontal>.p-splitter-gutter>.p-splitter-gutter-handle{height:24px;width:100%}.p-splitter-horizontal>.p-splitter-gutter{cursor:col-resize}.p-splitter-vertical.p-splitter-resizing{cursor:row-resize;-webkit-user-select:none;user-select:none}.p-splitter-vertical>.p-splitter-gutter{cursor:row-resize}.p-splitter-vertical>.p-splitter-gutter>.p-splitter-gutter-handle{width:24px;height:100%}.p-splitter-resizing .p-splitter-panel{pointer-events:none}}
`],encapsulation:2,changeDetection:0})}return e})(),Al=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=En({type:e});static \u0275inj=Sn({imports:[Fn,qn]})}return e})();var Kt="http://www.w3.org/1999/xhtml",Ye={svg:"http://www.w3.org/2000/svg",xhtml:Kt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function tt(e){var n=e+="",t=n.indexOf(":");return t>=0&&(n=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),Ye.hasOwnProperty(n)?{space:Ye[n],local:e}:e}function Co(e){return function(){var n=this.ownerDocument,t=this.namespaceURI;return t===Kt&&n.documentElement.namespaceURI===Kt?n.createElement(e):n.createElementNS(t,e)}}function So(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Qt(e){var n=tt(e);return(n.local?So:Co)(n)}function ko(){}function ht(e){return e==null?ko:function(){return this.querySelector(e)}}function Un(e){typeof e!="function"&&(e=ht(e));for(var n=this._groups,t=n.length,r=new Array(t),i=0;i<t;++i)for(var o=n[i],s=o.length,a=r[i]=new Array(s),u,l,c=0;c<s;++c)(u=o[c])&&(l=e.call(u,u.__data__,c,o))&&("__data__"in u&&(l.__data__=u.__data__),a[c]=l);return new I(r,this._parents)}function Fe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Eo(){return[]}function Lt(e){return e==null?Eo:function(){return this.querySelectorAll(e)}}function zo(e){return function(){return Fe(e.apply(this,arguments))}}function Wn(e){typeof e=="function"?e=zo(e):e=Lt(e);for(var n=this._groups,t=n.length,r=[],i=[],o=0;o<t;++o)for(var s=n[o],a=s.length,u,l=0;l<a;++l)(u=s[l])&&(r.push(e.call(u,u.__data__,l,s)),i.push(u));return new I(r,i)}function It(e){return function(){return this.matches(e)}}function jt(e){return function(n){return n.matches(e)}}var To=Array.prototype.find;function Mo(e){return function(){return To.call(this.children,e)}}function No(){return this.firstElementChild}function Gn(e){return this.select(e==null?No:Mo(typeof e=="function"?e:jt(e)))}var $o=Array.prototype.filter;function Bo(){return Array.from(this.children)}function Lo(e){return function(){return $o.call(this.children,e)}}function Jn(e){return this.selectAll(e==null?Bo:Lo(typeof e=="function"?e:jt(e)))}function Zn(e){typeof e!="function"&&(e=It(e));for(var n=this._groups,t=n.length,r=new Array(t),i=0;i<t;++i)for(var o=n[i],s=o.length,a=r[i]=[],u,l=0;l<s;++l)(u=o[l])&&e.call(u,u.__data__,l,o)&&a.push(u);return new I(r,this._parents)}function te(e){return new Array(e.length)}function Kn(){return new I(this._enter||this._groups.map(te),this._parents)}function At(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}At.prototype={constructor:At,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Qn(e){return function(){return e}}function Io(e,n,t,r,i,o){for(var s=0,a,u=n.length,l=o.length;s<l;++s)(a=n[s])?(a.__data__=o[s],r[s]=a):t[s]=new At(e,o[s]);for(;s<u;++s)(a=n[s])&&(i[s]=a)}function Ao(e,n,t,r,i,o,s){var a,u,l=new Map,c=n.length,h=o.length,p=new Array(c),d;for(a=0;a<c;++a)(u=n[a])&&(p[a]=d=s.call(u,u.__data__,a,n)+"",l.has(d)?i[a]=u:l.set(d,u));for(a=0;a<h;++a)d=s.call(e,o[a],a,o)+"",(u=l.get(d))?(r[a]=u,u.__data__=o[a],l.delete(d)):t[a]=new At(e,o[a]);for(a=0;a<c;++a)(u=n[a])&&l.get(p[a])===u&&(i[a]=u)}function Ro(e){return e.__data__}function jn(e,n){if(!arguments.length)return Array.from(this,Ro);var t=n?Ao:Io,r=this._parents,i=this._groups;typeof e!="function"&&(e=Qn(e));for(var o=i.length,s=new Array(o),a=new Array(o),u=new Array(o),l=0;l<o;++l){var c=r[l],h=i[l],p=h.length,d=Oo(e.call(c,c&&c.__data__,l,r)),g=d.length,y=a[l]=new Array(g),w=s[l]=new Array(g),_=u[l]=new Array(p);t(c,h,y,w,_,d,n);for(var k=0,M=0,T,B;k<g;++k)if(T=y[k]){for(k>=M&&(M=k+1);!(B=w[M])&&++M<g;);T._next=B||null}}return s=new I(s,r),s._enter=a,s._exit=u,s}function Oo(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tr(){return new I(this._exit||this._groups.map(te),this._parents)}function er(e,n,t){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),n!=null&&(i=n(i),i&&(i=i.selection())),t==null?o.remove():t(o),r&&i?r.merge(i).order():i}function nr(e){for(var n=e.selection?e.selection():e,t=this._groups,r=n._groups,i=t.length,o=r.length,s=Math.min(i,o),a=new Array(i),u=0;u<s;++u)for(var l=t[u],c=r[u],h=l.length,p=a[u]=new Array(h),d,g=0;g<h;++g)(d=l[g]||c[g])&&(p[g]=d);for(;u<i;++u)a[u]=t[u];return new I(a,this._parents)}function rr(){for(var e=this._groups,n=-1,t=e.length;++n<t;)for(var r=e[n],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function ir(e){e||(e=Po);function n(h,p){return h&&p?e(h.__data__,p.__data__):!h-!p}for(var t=this._groups,r=t.length,i=new Array(r),o=0;o<r;++o){for(var s=t[o],a=s.length,u=i[o]=new Array(a),l,c=0;c<a;++c)(l=s[c])&&(u[c]=l);u.sort(n)}return new I(i,this._parents).order()}function Po(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function or(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function ar(){return Array.from(this)}function sr(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var r=e[n],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function lr(){let e=0;for(let n of this)++e;return e}function ur(){return!this.node()}function cr(e){for(var n=this._groups,t=0,r=n.length;t<r;++t)for(var i=n[t],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}function Do(e){return function(){this.removeAttribute(e)}}function Xo(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ho(e,n){return function(){this.setAttribute(e,n)}}function Yo(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function Fo(e,n){return function(){var t=n.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function Vo(e,n){return function(){var t=n.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function fr(e,n){var t=tt(e);if(arguments.length<2){var r=this.node();return t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}return this.each((n==null?t.local?Xo:Do:typeof n=="function"?t.local?Vo:Fo:t.local?Yo:Ho)(t,n))}function ee(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function qo(e){return function(){this.style.removeProperty(e)}}function Uo(e,n,t){return function(){this.style.setProperty(e,n,t)}}function Wo(e,n,t){return function(){var r=n.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,t)}}function hr(e,n,t){return arguments.length>1?this.each((n==null?qo:typeof n=="function"?Wo:Uo)(e,n,t??"")):ot(this.node(),e)}function ot(e,n){return e.style.getPropertyValue(n)||ee(e).getComputedStyle(e,null).getPropertyValue(n)}function Go(e){return function(){delete this[e]}}function Jo(e,n){return function(){this[e]=n}}function Zo(e,n){return function(){var t=n.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function pr(e,n){return arguments.length>1?this.each((n==null?Go:typeof n=="function"?Zo:Jo)(e,n)):this.node()[e]}function dr(e){return e.trim().split(/^|\s+/)}function Ve(e){return e.classList||new mr(e)}function mr(e){this._node=e,this._names=dr(e.getAttribute("class")||"")}mr.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function gr(e,n){for(var t=Ve(e),r=-1,i=n.length;++r<i;)t.add(n[r])}function xr(e,n){for(var t=Ve(e),r=-1,i=n.length;++r<i;)t.remove(n[r])}function Ko(e){return function(){gr(this,e)}}function Qo(e){return function(){xr(this,e)}}function jo(e,n){return function(){(n.apply(this,arguments)?gr:xr)(this,e)}}function yr(e,n){var t=dr(e+"");if(arguments.length<2){for(var r=Ve(this.node()),i=-1,o=t.length;++i<o;)if(!r.contains(t[i]))return!1;return!0}return this.each((typeof n=="function"?jo:n?Ko:Qo)(t,n))}function ta(){this.textContent=""}function ea(e){return function(){this.textContent=e}}function na(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function _r(e){return arguments.length?this.each(e==null?ta:(typeof e=="function"?na:ea)(e)):this.node().textContent}function ra(){this.innerHTML=""}function ia(e){return function(){this.innerHTML=e}}function oa(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function vr(e){return arguments.length?this.each(e==null?ra:(typeof e=="function"?oa:ia)(e)):this.node().innerHTML}function aa(){this.nextSibling&&this.parentNode.appendChild(this)}function wr(){return this.each(aa)}function sa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function br(){return this.each(sa)}function Cr(e){var n=typeof e=="function"?e:Qt(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function la(){return null}function Sr(e,n){var t=typeof e=="function"?e:Qt(e),r=n==null?la:typeof n=="function"?n:ht(n);return this.select(function(){return this.insertBefore(t.apply(this,arguments),r.apply(this,arguments)||null)})}function ua(){var e=this.parentNode;e&&e.removeChild(this)}function kr(){return this.each(ua)}function ca(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function fa(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function Er(e){return this.select(e?fa:ca)}function zr(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ha(e){return function(n){e.call(this,n,this.__data__)}}function pa(e){return e.trim().split(/^|\s+/).map(function(n){var t="",r=n.indexOf(".");return r>=0&&(t=n.slice(r+1),n=n.slice(0,r)),{type:n,name:t}})}function da(e){return function(){var n=this.__on;if(n){for(var t=0,r=-1,i=n.length,o;t<i;++t)o=n[t],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):n[++r]=o;++r?n.length=r:delete this.__on}}}function ma(e,n,t){return function(){var r=this.__on,i,o=ha(n);if(r){for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=t),i.value=n;return}}this.addEventListener(e.type,o,t),i={type:e.type,name:e.name,value:n,listener:o,options:t},r?r.push(i):this.__on=[i]}}function Tr(e,n,t){var r=pa(e+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,l=a.length,c;u<l;++u)for(i=0,c=a[u];i<o;++i)if((s=r[i]).type===c.type&&s.name===c.name)return c.value}return}for(a=n?ma:da,i=0;i<o;++i)this.each(a(r[i],n,t));return this}function Mr(e,n,t){var r=ee(e),i=r.CustomEvent;typeof i=="function"?i=new i(n,t):(i=r.document.createEvent("Event"),t?(i.initEvent(n,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(n,!1,!1)),e.dispatchEvent(i)}function ga(e,n){return function(){return Mr(this,e,n)}}function xa(e,n){return function(){return Mr(this,e,n.apply(this,arguments))}}function Nr(e,n){return this.each((typeof n=="function"?xa:ga)(e,n))}function*$r(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var r=e[n],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var qe=[null];function I(e,n){this._groups=e,this._parents=n}function Br(){return new I([[document.documentElement]],qe)}function ya(){return this}I.prototype=Br.prototype={constructor:I,select:Un,selectAll:Wn,selectChild:Gn,selectChildren:Jn,filter:Zn,data:jn,enter:Kn,exit:tr,join:er,merge:nr,selection:ya,order:rr,sort:ir,call:or,nodes:ar,node:sr,size:lr,empty:ur,each:cr,attr:fr,style:hr,property:pr,classed:yr,text:_r,html:vr,raise:wr,lower:br,append:Cr,insert:Sr,remove:kr,clone:Er,datum:zr,on:Tr,dispatch:Nr,[Symbol.iterator]:$r};var W=Br;function D(e){return typeof e=="string"?new I([[document.querySelector(e)]],[document.documentElement]):new I([[e]],qe)}function Lr(e){let n;for(;n=e.sourceEvent;)e=n;return e}function et(e,n){if(e=Lr(e),n===void 0&&(n=e.currentTarget),n){var t=n.ownerSVGElement||n;if(t.createSVGPoint){var r=t.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[e.clientX-i.left-n.clientLeft,e.clientY-i.top-n.clientTop]}}return[e.pageX,e.pageY]}function ne(e,n){var t=0,r=0;return Float64Array.from(e,n===void 0?i=>t+=+i||0:i=>t+=+n(i,r++,e)||0)}function re(e,n){let t;if(n===void 0)for(let r of e)r!=null&&(t<r||t===void 0&&r>=r)&&(t=r);else{let r=-1;for(let i of e)(i=n(i,++r,e))!=null&&(t<i||t===void 0&&i>=i)&&(t=i)}return t}function ie(e,n){let t;if(n===void 0)for(let r of e)r!=null&&(t>r||t===void 0&&r>=r)&&(t=r);else{let r=-1;for(let i of e)(i=n(i,++r,e))!=null&&(t>i||t===void 0&&i>=i)&&(t=i)}return t}function oe(e,n){let t=0;if(n===void 0)for(let r of e)(r=+r)&&(t+=r);else{let r=-1;for(let i of e)(i=+n(i,++r,e))&&(t+=i)}return t}function _a(e){var n=0,t=e.children,r=t&&t.length;if(!r)n=1;else for(;--r>=0;)n+=t[r].value;e.value=n}function Ir(){return this.eachAfter(_a)}function Ar(e,n){let t=-1;for(let r of this)e.call(n,r,++t,this);return this}function Rr(e,n){for(var t=this,r=[t],i,o,s=-1;t=r.pop();)if(e.call(n,t,++s,this),i=t.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Or(e,n){for(var t=this,r=[t],i=[],o,s,a,u=-1;t=r.pop();)if(i.push(t),o=t.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;t=i.pop();)e.call(n,t,++u,this);return this}function Pr(e,n){let t=-1;for(let r of this)if(e.call(n,r,++t,this))return r}function Dr(e){return this.eachAfter(function(n){for(var t=+e(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)t+=r[i].value;n.value=t})}function Xr(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function Hr(e){for(var n=this,t=va(n,e),r=[n];n!==t;)n=n.parent,r.push(n);for(var i=r.length;e!==t;)r.splice(i,0,e),e=e.parent;return r}function va(e,n){if(e===n)return e;var t=e.ancestors(),r=n.ancestors(),i=null;for(e=t.pop(),n=r.pop();e===n;)i=e,e=t.pop(),n=r.pop();return i}function Yr(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function Fr(){return Array.from(this)}function Vr(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function qr(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n}function*Ur(){var e=this,n,t=[e],r,i,o;do for(n=t.reverse(),t=[];e=n.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)t.push(r[i]);while(t.length)}function Ue(e,n){e instanceof Map?(e=[void 0,e],n===void 0&&(n=Ca)):n===void 0&&(n=ba);for(var t=new at(e),r,i=[t],o,s,a,u;r=i.pop();)if((s=n(r.data))&&(u=(s=Array.from(s)).length))for(r.children=s,a=u-1;a>=0;--a)i.push(o=s[a]=new at(s[a])),o.parent=r,o.depth=r.depth+1;return t.eachBefore(We)}function wa(){return Ue(this).eachBefore(Sa)}function ba(e){return e.children}function Ca(e){return Array.isArray(e)?e[1]:null}function Sa(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function We(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function at(e){this.data=e,this.depth=this.height=0,this.parent=null}at.prototype=Ue.prototype={constructor:at,count:Ir,each:Ar,eachAfter:Or,eachBefore:Rr,find:Pr,sum:Dr,sort:Xr,path:Hr,ancestors:Yr,descendants:Fr,leaves:Vr,links:qr,copy:wa,[Symbol.iterator]:Ur};function ae(e){return e==null?null:ka(e)}function ka(e){if(typeof e!="function")throw new Error;return e}var Ea={depth:-1},Wr={},Ge={};function za(e){return e.id}function Ta(e){return e.parentId}function Ze(){var e=za,n=Ta,t;function r(i){var o=Array.from(i),s=e,a=n,u,l,c,h,p,d,g,y,w=new Map;if(t!=null){let _=o.map((T,B)=>Ma(t(T,B,i))),k=_.map(Gr),M=new Set(_).add("");for(let T of k)M.has(T)||(M.add(T),_.push(T),k.push(Gr(T)),o.push(Ge));s=(T,B)=>_[B],a=(T,B)=>k[B]}for(c=0,u=o.length;c<u;++c)l=o[c],d=o[c]=new at(l),(g=s(l,c,i))!=null&&(g+="")&&(y=d.id=g,w.set(y,w.has(y)?Wr:d)),(g=a(l,c,i))!=null&&(g+="")&&(d.parent=g);for(c=0;c<u;++c)if(d=o[c],g=d.parent){if(p=w.get(g),!p)throw new Error("missing: "+g);if(p===Wr)throw new Error("ambiguous: "+g);p.children?p.children.push(d):p.children=[d],d.parent=p}else{if(h)throw new Error("multiple roots");h=d}if(!h)throw new Error("no root");if(t!=null){for(;h.data===Ge&&h.children.length===1;)h=h.children[0],--u;for(let _=o.length-1;_>=0&&(d=o[_],d.data===Ge);--_)d.data=null}if(h.parent=Ea,h.eachBefore(function(_){_.depth=_.parent.depth+1,--u}).eachBefore(We),h.parent=null,u>0)throw new Error("cycle");return h}return r.id=function(i){return arguments.length?(e=ae(i),r):e},r.parentId=function(i){return arguments.length?(n=ae(i),r):n},r.path=function(i){return arguments.length?(t=ae(i),r):t},r}function Ma(e){e=`${e}`;let n=e.length;return Je(e,n-1)&&!Je(e,n-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function Gr(e){let n=e.length;if(n<2)return"";for(;--n>1&&!Je(e,n););return e.slice(0,n)}function Je(e,n){if(e[n]==="/"){let t=0;for(;n>0&&e[--n]==="\\";)++t;if(!(t&1))return!0}return!1}function Na(e,n){return e.parent===n.parent?1:2}function Ke(e){var n=e.children;return n?n[0]:e.t}function Qe(e){var n=e.children;return n?n[n.length-1]:e.t}function $a(e,n,t){var r=t/(n.i-e.i);n.c-=r,n.s+=t,e.c+=r,n.z+=t,n.m+=t}function Ba(e){for(var n=0,t=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=n,o.m+=n,n+=o.s+(t+=o.c)}function La(e,n,t){return e.a.parent===n.parent?e.a:t}function se(e,n){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}se.prototype=Object.create(at.prototype);function Ia(e){for(var n=new se(e,0),t,r=[n],i,o,s,a;t=r.pop();)if(o=t._.children)for(t.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=t.children[s]=new se(o[s],s)),i.parent=t;return(n.parent=new se(null,0)).children=[n],n}function je(){var e=Na,n=1,t=1,r=null;function i(l){var c=Ia(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)l.eachBefore(u);else{var h=l,p=l,d=l;l.eachBefore(function(k){k.x<h.x&&(h=k),k.x>p.x&&(p=k),k.depth>d.depth&&(d=k)});var g=h===p?1:e(h,p)/2,y=g-h.x,w=n/(p.x+g+y),_=t/(d.depth||1);l.eachBefore(function(k){k.x=(k.x+y)*w,k.y=k.depth*_})}return l}function o(l){var c=l.children,h=l.parent.children,p=l.i?h[l.i-1]:null;if(c){Ba(l);var d=(c[0].z+c[c.length-1].z)/2;p?(l.z=p.z+e(l._,p._),l.m=l.z-d):l.z=d}else p&&(l.z=p.z+e(l._,p._));l.parent.A=a(l,p,l.parent.A||h[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,h){if(c){for(var p=l,d=l,g=c,y=p.parent.children[0],w=p.m,_=d.m,k=g.m,M=y.m,T;g=Qe(g),p=Ke(p),g&&p;)y=Ke(y),d=Qe(d),d.a=l,T=g.z+k-p.z-w+e(g._,p._),T>0&&($a(La(g,l,h),l,T),w+=T,_+=T),k+=g.m,w+=p.m,M+=y.m,_+=d.m;g&&!Qe(d)&&(d.t=g,d.m+=k-_),p&&!Ke(y)&&(y.t=p,y.m+=w-M,h=l)}return h}function u(l){l.x*=n,l.y=l.depth*t}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,n=+l[0],t=+l[1],i):r?null:[n,t]},i.nodeSize=function(l){return arguments.length?(r=!0,n=+l[0],t=+l[1],i):r?[n,t]:null},i}var Aa={value:()=>{}};function Zr(){for(var e=0,n=arguments.length,t={},r;e<n;++e){if(!(r=arguments[e]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new le(t)}function le(e){this._=e}function Ra(e,n){return e.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");if(i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}le.prototype=Zr.prototype={constructor:le,on:function(e,n){var t=this._,r=Ra(e+"",t),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=Oa(t[i],e.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<s;)if(i=(e=r[o]).type)t[i]=Jr(t[i],e.name,n);else if(n==null)for(i in t)t[i]=Jr(t[i],e.name,null);return this},copy:function(){var e={},n=this._;for(var t in n)e[t]=n[t].slice();return new le(e)},call:function(e,n){if((i=arguments.length-2)>0)for(var t=new Array(i),r=0,i,o;r<i;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(n,t)},apply:function(e,n,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(n,t)}};function Oa(e,n){for(var t=0,r=e.length,i;t<r;++t)if((i=e[t]).name===n)return i.value}function Jr(e,n,t){for(var r=0,i=e.length;r<i;++r)if(e[r].name===n){e[r]=Aa,e=e.slice(0,r).concat(e.slice(r+1));break}return t!=null&&e.push({name:n,value:t}),e}var Rt=Zr;var ue={capture:!0,passive:!1};function ce(e){e.preventDefault(),e.stopImmediatePropagation()}function tn(e){var n=e.document.documentElement,t=D(e).on("dragstart.drag",ce,ue);"onselectstart"in n?t.on("selectstart.drag",ce,ue):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function en(e,n){var t=e.document.documentElement,r=D(e).on("dragstart.drag",null);n&&(r.on("click.drag",ce,ue),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in t?r.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}function fe(e,n,t){e.prototype=n.prototype=t,t.constructor=e}function nn(e,n){var t=Object.create(e.prototype);for(var r in n)t[r]=n[r];return t}function Dt(){}var Ot=.7,de=1/Ot,bt="\\s*([+-]?\\d+)\\s*",Pt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Z="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pa=/^#([0-9a-f]{3,8})$/,Da=new RegExp(`^rgb\\(${bt},${bt},${bt}\\)$`),Xa=new RegExp(`^rgb\\(${Z},${Z},${Z}\\)$`),Ha=new RegExp(`^rgba\\(${bt},${bt},${bt},${Pt}\\)$`),Ya=new RegExp(`^rgba\\(${Z},${Z},${Z},${Pt}\\)$`),Fa=new RegExp(`^hsl\\(${Pt},${Z},${Z}\\)$`),Va=new RegExp(`^hsla\\(${Pt},${Z},${Z},${Pt}\\)$`),Kr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fe(Dt,st,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Qr,formatHex:Qr,formatHex8:qa,formatHsl:Ua,formatRgb:jr,toString:jr});function Qr(){return this.rgb().formatHex()}function qa(){return this.rgb().formatHex8()}function Ua(){return oi(this).formatHsl()}function jr(){return this.rgb().formatRgb()}function st(e){var n,t;return e=(e+"").trim().toLowerCase(),(n=Pa.exec(e))?(t=n[1].length,n=parseInt(n[1],16),t===6?ti(n):t===3?new H(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):t===8?he(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):t===4?he(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Da.exec(e))?new H(n[1],n[2],n[3],1):(n=Xa.exec(e))?new H(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Ha.exec(e))?he(n[1],n[2],n[3],n[4]):(n=Ya.exec(e))?he(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Fa.exec(e))?ri(n[1],n[2]/100,n[3]/100,1):(n=Va.exec(e))?ri(n[1],n[2]/100,n[3]/100,n[4]):Kr.hasOwnProperty(e)?ti(Kr[e]):e==="transparent"?new H(NaN,NaN,NaN,0):null}function ti(e){return new H(e>>16&255,e>>8&255,e&255,1)}function he(e,n,t,r){return r<=0&&(e=n=t=NaN),new H(e,n,t,r)}function Wa(e){return e instanceof Dt||(e=st(e)),e?(e=e.rgb(),new H(e.r,e.g,e.b,e.opacity)):new H}function Ct(e,n,t,r){return arguments.length===1?Wa(e):new H(e,n,t,r??1)}function H(e,n,t,r){this.r=+e,this.g=+n,this.b=+t,this.opacity=+r}fe(H,Ct,nn(Dt,{brighter(e){return e=e==null?de:Math.pow(de,e),new H(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ot:Math.pow(Ot,e),new H(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new H(dt(this.r),dt(this.g),dt(this.b),me(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ei,formatHex:ei,formatHex8:Ga,formatRgb:ni,toString:ni}));function ei(){return`#${pt(this.r)}${pt(this.g)}${pt(this.b)}`}function Ga(){return`#${pt(this.r)}${pt(this.g)}${pt(this.b)}${pt((isNaN(this.opacity)?1:this.opacity)*255)}`}function ni(){let e=me(this.opacity);return`${e===1?"rgb(":"rgba("}${dt(this.r)}, ${dt(this.g)}, ${dt(this.b)}${e===1?")":`, ${e})`}`}function me(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function dt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pt(e){return e=dt(e),(e<16?"0":"")+e.toString(16)}function ri(e,n,t,r){return r<=0?e=n=t=NaN:t<=0||t>=1?e=n=NaN:n<=0&&(e=NaN),new G(e,n,t,r)}function oi(e){if(e instanceof G)return new G(e.h,e.s,e.l,e.opacity);if(e instanceof Dt||(e=st(e)),!e)return new G;if(e instanceof G)return e;e=e.rgb();var n=e.r/255,t=e.g/255,r=e.b/255,i=Math.min(n,t,r),o=Math.max(n,t,r),s=NaN,a=o-i,u=(o+i)/2;return a?(n===o?s=(t-r)/a+(t<r)*6:t===o?s=(r-n)/a+2:s=(n-t)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new G(s,a,u,e.opacity)}function ai(e,n,t,r){return arguments.length===1?oi(e):new G(e,n,t,r??1)}function G(e,n,t,r){this.h=+e,this.s=+n,this.l=+t,this.opacity=+r}fe(G,ai,nn(Dt,{brighter(e){return e=e==null?de:Math.pow(de,e),new G(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ot:Math.pow(Ot,e),new G(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*n,i=2*t-r;return new H(rn(e>=240?e-240:e+120,i,r),rn(e,i,r),rn(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new G(ii(this.h),pe(this.s),pe(this.l),me(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=me(this.opacity);return`${e===1?"hsl(":"hsla("}${ii(this.h)}, ${pe(this.s)*100}%, ${pe(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ii(e){return e=(e||0)%360,e<0?e+360:e}function pe(e){return Math.max(0,Math.min(1,e||0))}function rn(e,n,t){return(e<60?n+(t-n)*e/60:e<180?t:e<240?n+(t-n)*(240-e)/60:n)*255}function on(e,n,t,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*n+(4-6*o+3*s)*t+(1+3*e+3*o-3*s)*r+s*i)/6}function si(e){var n=e.length-1;return function(t){var r=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<n-1?e[r+2]:2*o-i;return on((t-r/n)*n,s,i,o,a)}}function li(e){var n=e.length;return function(t){var r=Math.floor(((t%=1)<0?++t:t)*n),i=e[(r+n-1)%n],o=e[r%n],s=e[(r+1)%n],a=e[(r+2)%n];return on((t-r/n)*n,i,o,s,a)}}var an=e=>()=>e;function Ja(e,n){return function(t){return e+t*n}}function Za(e,n,t){return e=Math.pow(e,t),n=Math.pow(n,t)-e,t=1/t,function(r){return Math.pow(e+r*n,t)}}function ui(e){return(e=+e)==1?ge:function(n,t){return t-n?Za(n,t,e):an(isNaN(n)?t:n)}}function ge(e,n){var t=n-e;return t?Ja(e,t):an(isNaN(e)?n:e)}var xe=function e(n){var t=ui(n);function r(i,o){var s=t((i=Ct(i)).r,(o=Ct(o)).r),a=t(i.g,o.g),u=t(i.b,o.b),l=ge(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function ci(e){return function(n){var t=n.length,r=new Array(t),i=new Array(t),o=new Array(t),s,a;for(s=0;s<t;++s)a=Ct(n[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var Ka=ci(si),Qa=ci(li);function q(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}var ln=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sn=new RegExp(ln.source,"g");function ja(e){return function(){return e}}function ts(e){return function(n){return e(n)+""}}function un(e,n){var t=ln.lastIndex=sn.lastIndex=0,r,i,o,s=-1,a=[],u=[];for(e=e+"",n=n+"";(r=ln.exec(e))&&(i=sn.exec(n));)(o=i.index)>t&&(o=n.slice(t,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:q(r,i)})),t=sn.lastIndex;return t<n.length&&(o=n.slice(t),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?ts(u[0].x):ja(n):(n=u.length,function(l){for(var c=0,h;c<n;++c)a[(h=u[c]).i]=h.x(l);return a.join("")})}var fi=180/Math.PI,ye={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cn(e,n,t,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+n*n))&&(e/=s,n/=s),(u=e*t+n*r)&&(t-=e*u,r-=n*u),(a=Math.sqrt(t*t+r*r))&&(t/=a,r/=a,u/=a),e*r<n*t&&(e=-e,n=-n,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(n,e)*fi,skewX:Math.atan(u)*fi,scaleX:s,scaleY:a}}var _e;function hi(e){let n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?ye:cn(n.a,n.b,n.c,n.d,n.e,n.f)}function pi(e){return e==null?ye:(_e||(_e=document.createElementNS("http://www.w3.org/2000/svg","g")),_e.setAttribute("transform",e),(e=_e.transform.baseVal.consolidate())?(e=e.matrix,cn(e.a,e.b,e.c,e.d,e.e,e.f)):ye)}function di(e,n,t,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,h,p,d,g){if(l!==h||c!==p){var y=d.push("translate(",null,n,null,t);g.push({i:y-4,x:q(l,h)},{i:y-2,x:q(c,p)})}else(h||p)&&d.push("translate("+h+n+p+t)}function s(l,c,h,p){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),p.push({i:h.push(i(h)+"rotate(",null,r)-2,x:q(l,c)})):c&&h.push(i(h)+"rotate("+c+r)}function a(l,c,h,p){l!==c?p.push({i:h.push(i(h)+"skewX(",null,r)-2,x:q(l,c)}):c&&h.push(i(h)+"skewX("+c+r)}function u(l,c,h,p,d,g){if(l!==h||c!==p){var y=d.push(i(d)+"scale(",null,",",null,")");g.push({i:y-4,x:q(l,h)},{i:y-2,x:q(c,p)})}else(h!==1||p!==1)&&d.push(i(d)+"scale("+h+","+p+")")}return function(l,c){var h=[],p=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,h,p),s(l.rotate,c.rotate,h,p),a(l.skewX,c.skewX,h,p),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,h,p),l=c=null,function(d){for(var g=-1,y=p.length,w;++g<y;)h[(w=p[g]).i]=w.x(d);return h.join("")}}}var fn=di(hi,"px, ","px)","deg)"),hn=di(pi,", ",")",")");var es=1e-12;function mi(e){return((e=Math.exp(e))+1/e)/2}function ns(e){return((e=Math.exp(e))-1/e)/2}function rs(e){return((e=Math.exp(2*e))-1)/(e+1)}var pn=function e(n,t,r){function i(o,s){var a=o[0],u=o[1],l=o[2],c=s[0],h=s[1],p=s[2],d=c-a,g=h-u,y=d*d+g*g,w,_;if(y<es)_=Math.log(p/l)/n,w=function(Y){return[a+Y*d,u+Y*g,l*Math.exp(n*Y*_)]};else{var k=Math.sqrt(y),M=(p*p-l*l+r*y)/(2*l*t*k),T=(p*p-l*l-r*y)/(2*p*t*k),B=Math.log(Math.sqrt(M*M+1)-M),P=Math.log(Math.sqrt(T*T+1)-T);_=(P-B)/n,w=function(Y){var rt=Y*_,Mt=mi(B),it=l/(t*k)*(Mt*rs(n*rt+B)-ns(B));return[a+it*d,u+it*g,l*Mt/mi(n*rt+B)]}}return w.duration=_*1e3*n/Math.SQRT2,w}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return e(s,a,u)},i}(Math.SQRT2,2,4);var St=0,Ht=0,Xt=0,xi=1e3,ve,Yt,we=0,mt=0,be=0,Ft=typeof performance=="object"&&performance.now?performance:Date,yi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function qt(){return mt||(yi(is),mt=Ft.now()+be)}function is(){mt=0}function Vt(){this._call=this._time=this._next=null}Vt.prototype=Ce.prototype={constructor:Vt,restart:function(e,n,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?qt():+t)+(n==null?0:+n),!this._next&&Yt!==this&&(Yt?Yt._next=this:ve=this,Yt=this),this._call=e,this._time=t,dn()},stop:function(){this._call&&(this._call=null,this._time=1/0,dn())}};function Ce(e,n,t){var r=new Vt;return r.restart(e,n,t),r}function _i(){qt(),++St;for(var e=ve,n;e;)(n=mt-e._time)>=0&&e._call.call(void 0,n),e=e._next;--St}function gi(){mt=(we=Ft.now())+be,St=Ht=0;try{_i()}finally{St=0,as(),mt=0}}function os(){var e=Ft.now(),n=e-we;n>xi&&(be-=n,we=e)}function as(){for(var e,n=ve,t,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:ve=t);Yt=e,dn(r)}function dn(e){if(!St){Ht&&(Ht=clearTimeout(Ht));var n=e-mt;n>24?(e<1/0&&(Ht=setTimeout(gi,e-Ft.now()-be)),Xt&&(Xt=clearInterval(Xt))):(Xt||(we=Ft.now(),Xt=setInterval(os,xi)),St=1,yi(gi))}}function Se(e,n,t){var r=new Vt;return n=n==null?0:+n,r.restart(i=>{r.stop(),e(i+n)},n,t),r}var ss=Rt("start","end","cancel","interrupt"),ls=[],bi=0,vi=1,Ee=2,ke=3,wi=4,ze=5,Ut=6;function lt(e,n,t,r,i,o){var s=e.__transition;if(!s)e.__transition={};else if(t in s)return;us(e,t,{name:n,index:r,group:i,on:ss,tween:ls,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:bi})}function Wt(e,n){var t=R(e,n);if(t.state>bi)throw new Error("too late; already scheduled");return t}function O(e,n){var t=R(e,n);if(t.state>ke)throw new Error("too late; already running");return t}function R(e,n){var t=e.__transition;if(!t||!(t=t[n]))throw new Error("transition not found");return t}function us(e,n,t){var r=e.__transition,i;r[n]=t,t.timer=Ce(o,0,t.time);function o(l){t.state=vi,t.timer.restart(s,t.delay,t.time),t.delay<=l&&s(l-t.delay)}function s(l){var c,h,p,d;if(t.state!==vi)return u();for(c in r)if(d=r[c],d.name===t.name){if(d.state===ke)return Se(s);d.state===wi?(d.state=Ut,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[c]):+c<n&&(d.state=Ut,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[c])}if(Se(function(){t.state===ke&&(t.state=wi,t.timer.restart(a,t.delay,t.time),a(l))}),t.state=Ee,t.on.call("start",e,e.__data__,t.index,t.group),t.state===Ee){for(t.state=ke,i=new Array(p=t.tween.length),c=0,h=-1;c<p;++c)(d=t.tween[c].value.call(e,e.__data__,t.index,t.group))&&(i[++h]=d);i.length=h+1}}function a(l){for(var c=l<t.duration?t.ease.call(null,l/t.duration):(t.timer.restart(u),t.state=ze,1),h=-1,p=i.length;++h<p;)i[h].call(e,c);t.state===ze&&(t.on.call("end",e,e.__data__,t.index,t.group),u())}function u(){t.state=Ut,t.timer.stop(),delete r[n];for(var l in r)return;delete e.__transition}}function gt(e,n){var t=e.__transition,r,i,o=!0,s;if(t){n=n==null?null:n+"";for(s in t){if((r=t[s]).name!==n){o=!1;continue}i=r.state>Ee&&r.state<ze,r.state=Ut,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete t[s]}o&&delete e.__transition}}function Ci(e){return this.each(function(){gt(this,e)})}function cs(e,n){var t,r;return function(){var i=O(this,e),o=i.tween;if(o!==t){r=t=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===n){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function fs(e,n,t){var r,i;if(typeof t!="function")throw new Error;return function(){var o=O(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:n,value:t},u=0,l=i.length;u<l;++u)if(i[u].name===n){i[u]=a;break}u===l&&i.push(a)}o.tween=i}}function Si(e,n){var t=this._id;if(e+="",arguments.length<2){for(var r=R(this.node(),t).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===e)return s.value;return null}return this.each((n==null?cs:fs)(t,e,n))}function kt(e,n,t){var r=e._id;return e.each(function(){var i=O(this,r);(i.value||(i.value={}))[n]=t.apply(this,arguments)}),function(i){return R(i,r).value[n]}}function Te(e,n){var t;return(typeof n=="number"?q:n instanceof st?xe:(t=st(n))?(n=t,xe):un)(e,n)}function hs(e){return function(){this.removeAttribute(e)}}function ps(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ds(e,n,t){var r,i=t+"",o;return function(){var s=this.getAttribute(e);return s===i?null:s===r?o:o=n(r=s,t)}}function ms(e,n,t){var r,i=t+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===r?o:o=n(r=s,t)}}function gs(e,n,t){var r,i,o;return function(){var s,a=t(this),u;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),u=a+"",s===u?null:s===r&&u===i?o:(i=u,o=n(r=s,a)))}}function xs(e,n,t){var r,i,o;return function(){var s,a=t(this),u;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),u=a+"",s===u?null:s===r&&u===i?o:(i=u,o=n(r=s,a)))}}function ki(e,n){var t=tt(e),r=t==="transform"?hn:Te;return this.attrTween(e,typeof n=="function"?(t.local?xs:gs)(t,r,kt(this,"attr."+e,n)):n==null?(t.local?ps:hs)(t):(t.local?ms:ds)(t,r,n))}function ys(e,n){return function(t){this.setAttribute(e,n.call(this,t))}}function _s(e,n){return function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}}function vs(e,n){var t,r;function i(){var o=n.apply(this,arguments);return o!==r&&(t=(r=o)&&_s(e,o)),t}return i._value=n,i}function ws(e,n){var t,r;function i(){var o=n.apply(this,arguments);return o!==r&&(t=(r=o)&&ys(e,o)),t}return i._value=n,i}function Ei(e,n){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(n==null)return this.tween(t,null);if(typeof n!="function")throw new Error;var r=tt(e);return this.tween(t,(r.local?vs:ws)(r,n))}function bs(e,n){return function(){Wt(this,e).delay=+n.apply(this,arguments)}}function Cs(e,n){return n=+n,function(){Wt(this,e).delay=n}}function zi(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?bs:Cs)(n,e)):R(this.node(),n).delay}function Ss(e,n){return function(){O(this,e).duration=+n.apply(this,arguments)}}function ks(e,n){return n=+n,function(){O(this,e).duration=n}}function Ti(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?Ss:ks)(n,e)):R(this.node(),n).duration}function Es(e,n){if(typeof n!="function")throw new Error;return function(){O(this,e).ease=n}}function Mi(e){var n=this._id;return arguments.length?this.each(Es(n,e)):R(this.node(),n).ease}function zs(e,n){return function(){var t=n.apply(this,arguments);if(typeof t!="function")throw new Error;O(this,e).ease=t}}function Ni(e){if(typeof e!="function")throw new Error;return this.each(zs(this._id,e))}function $i(e){typeof e!="function"&&(e=It(e));for(var n=this._groups,t=n.length,r=new Array(t),i=0;i<t;++i)for(var o=n[i],s=o.length,a=r[i]=[],u,l=0;l<s;++l)(u=o[l])&&e.call(u,u.__data__,l,o)&&a.push(u);return new X(r,this._parents,this._name,this._id)}function Bi(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,t=e._groups,r=n.length,i=t.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var u=n[a],l=t[a],c=u.length,h=s[a]=new Array(c),p,d=0;d<c;++d)(p=u[d]||l[d])&&(h[d]=p);for(;a<r;++a)s[a]=n[a];return new X(s,this._parents,this._name,this._id)}function Ts(e){return(e+"").trim().split(/^|\s+/).every(function(n){var t=n.indexOf(".");return t>=0&&(n=n.slice(0,t)),!n||n==="start"})}function Ms(e,n,t){var r,i,o=Ts(n)?Wt:O;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(n,t),s.on=i}}function Li(e,n){var t=this._id;return arguments.length<2?R(this.node(),t).on.on(e):this.each(Ms(t,e,n))}function Ns(e){return function(){var n=this.parentNode;for(var t in this.__transition)if(+t!==e)return;n&&n.removeChild(this)}}function Ii(){return this.on("end.remove",Ns(this._id))}function Ai(e){var n=this._name,t=this._id;typeof e!="function"&&(e=ht(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],u=a.length,l=o[s]=new Array(u),c,h,p=0;p<u;++p)(c=a[p])&&(h=e.call(c,c.__data__,p,a))&&("__data__"in c&&(h.__data__=c.__data__),l[p]=h,lt(l[p],n,t,p,l,R(c,t)));return new X(o,this._parents,n,t)}function Ri(e){var n=this._name,t=this._id;typeof e!="function"&&(e=Lt(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var u=r[a],l=u.length,c,h=0;h<l;++h)if(c=u[h]){for(var p=e.call(c,c.__data__,h,u),d,g=R(c,t),y=0,w=p.length;y<w;++y)(d=p[y])&&lt(d,n,t,y,p,g);o.push(p),s.push(c)}return new X(o,s,n,t)}var $s=W.prototype.constructor;function Oi(){return new $s(this._groups,this._parents)}function Bs(e,n){var t,r,i;return function(){var o=ot(this,e),s=(this.style.removeProperty(e),ot(this,e));return o===s?null:o===t&&s===r?i:i=n(t=o,r=s)}}function Pi(e){return function(){this.style.removeProperty(e)}}function Ls(e,n,t){var r,i=t+"",o;return function(){var s=ot(this,e);return s===i?null:s===r?o:o=n(r=s,t)}}function Is(e,n,t){var r,i,o;return function(){var s=ot(this,e),a=t(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(e),ot(this,e))),s===u?null:s===r&&u===i?o:(i=u,o=n(r=s,a))}}function As(e,n){var t,r,i,o="style."+n,s="end."+o,a;return function(){var u=O(this,e),l=u.on,c=u.value[o]==null?a||(a=Pi(n)):void 0;(l!==t||i!==c)&&(r=(t=l).copy()).on(s,i=c),u.on=r}}function Di(e,n,t){var r=(e+="")=="transform"?fn:Te;return n==null?this.styleTween(e,Bs(e,r)).on("end.style."+e,Pi(e)):typeof n=="function"?this.styleTween(e,Is(e,r,kt(this,"style."+e,n))).each(As(this._id,e)):this.styleTween(e,Ls(e,r,n),t).on("end.style."+e,null)}function Rs(e,n,t){return function(r){this.style.setProperty(e,n.call(this,r),t)}}function Os(e,n,t){var r,i;function o(){var s=n.apply(this,arguments);return s!==i&&(r=(i=s)&&Rs(e,s,t)),r}return o._value=n,o}function Xi(e,n,t){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;return this.tween(r,Os(e,n,t??""))}function Ps(e){return function(){this.textContent=e}}function Ds(e){return function(){var n=e(this);this.textContent=n??""}}function Hi(e){return this.tween("text",typeof e=="function"?Ds(kt(this,"text",e)):Ps(e==null?"":e+""))}function Xs(e){return function(n){this.textContent=e.call(this,n)}}function Hs(e){var n,t;function r(){var i=e.apply(this,arguments);return i!==t&&(n=(t=i)&&Xs(i)),n}return r._value=e,r}function Yi(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Hs(e))}function Fi(){for(var e=this._name,n=this._id,t=Me(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,u,l=0;l<a;++l)if(u=s[l]){var c=R(u,n);lt(u,e,t,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new X(r,this._parents,e,t)}function Vi(){var e,n,t=this,r=t._id,i=t.size();return new Promise(function(o,s){var a={value:s},u={value:function(){--i===0&&o()}};t.each(function(){var l=O(this,r),c=l.on;c!==e&&(n=(e=c).copy(),n._.cancel.push(a),n._.interrupt.push(a),n._.end.push(u)),l.on=n}),i===0&&o()})}var Ys=0;function X(e,n,t,r){this._groups=e,this._parents=n,this._name=t,this._id=r}function qi(e){return W().transition(e)}function Me(){return++Ys}var nt=W.prototype;X.prototype=qi.prototype={constructor:X,select:Ai,selectAll:Ri,selectChild:nt.selectChild,selectChildren:nt.selectChildren,filter:$i,merge:Bi,selection:Oi,transition:Fi,call:nt.call,nodes:nt.nodes,node:nt.node,size:nt.size,empty:nt.empty,each:nt.each,on:Li,attr:ki,attrTween:Ei,style:Di,styleTween:Xi,text:Hi,textTween:Yi,remove:Ii,tween:Si,delay:zi,duration:Ti,ease:Mi,easeVarying:Ni,end:Vi,[Symbol.iterator]:nt[Symbol.iterator]};function Ne(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Fs={time:null,delay:0,duration:250,ease:Ne};function Vs(e,n){for(var t;!(t=e.__transition)||!(t=t[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return t}function Ui(e){var n,t;e instanceof X?(n=e._id,e=e._name):(n=Me(),(t=Fs).time=qt(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,u,l=0;l<a;++l)(u=s[l])&&lt(u,e,n,l,s,t||Vs(u,n));return new X(r,this._parents,e,n)}W.prototype.interrupt=Ci;W.prototype.transition=Ui;var Gt=e=>()=>e;function mn(e,{sourceEvent:n,target:t,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function J(e,n,t){this.k=e,this.x=n,this.y=t}J.prototype={constructor:J,scale:function(e){return e===1?this:new J(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new J(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var xt=new J(1,0,0);gn.prototype=J.prototype;function gn(e){for(;!e.__zoom;)if(!(e=e.parentNode))return xt;return e.__zoom}function $e(e){e.stopImmediatePropagation()}function Et(e){e.preventDefault(),e.stopImmediatePropagation()}function qs(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Us(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Wi(){return this.__zoom||xt}function Ws(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Gs(){return navigator.maxTouchPoints||"ontouchstart"in this}function Js(e,n,t){var r=e.invertX(n[0][0])-t[0][0],i=e.invertX(n[1][0])-t[1][0],o=e.invertY(n[0][1])-t[0][1],s=e.invertY(n[1][1])-t[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function xn(){var e=qs,n=Us,t=Js,r=Ws,i=Gs,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,u=pn,l=Rt("start","zoom","end"),c,h,p,d=500,g=150,y=0,w=10;function _(m){m.property("__zoom",Wi).on("wheel.zoom",rt,{passive:!1}).on("mousedown.zoom",Mt).on("dblclick.zoom",it).filter(i).on("touchstart.zoom",vt).on("touchmove.zoom",K).on("touchend.zoom touchcancel.zoom",Cn).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(m,C,x,S){var E=m.selection?m.selection():m;E.property("__zoom",Wi),m!==E?B(m,C,x,S):E.interrupt().each(function(){P(this,arguments).event(S).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},_.scaleBy=function(m,C,x,S){_.scaleTo(m,function(){var E=this.__zoom.k,f=typeof C=="function"?C.apply(this,arguments):C;return E*f},x,S)},_.scaleTo=function(m,C,x,S){_.transform(m,function(){var E=n.apply(this,arguments),f=this.__zoom,v=x==null?T(E):typeof x=="function"?x.apply(this,arguments):x,b=f.invert(v),z=typeof C=="function"?C.apply(this,arguments):C;return t(M(k(f,z),v,b),E,s)},x,S)},_.translateBy=function(m,C,x,S){_.transform(m,function(){return t(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof x=="function"?x.apply(this,arguments):x),n.apply(this,arguments),s)},null,S)},_.translateTo=function(m,C,x,S,E){_.transform(m,function(){var f=n.apply(this,arguments),v=this.__zoom,b=S==null?T(f):typeof S=="function"?S.apply(this,arguments):S;return t(xt.translate(b[0],b[1]).scale(v.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof x=="function"?-x.apply(this,arguments):-x),f,s)},S,E)};function k(m,C){return C=Math.max(o[0],Math.min(o[1],C)),C===m.k?m:new J(C,m.x,m.y)}function M(m,C,x){var S=C[0]-x[0]*m.k,E=C[1]-x[1]*m.k;return S===m.x&&E===m.y?m:new J(m.k,S,E)}function T(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function B(m,C,x,S){m.on("start.zoom",function(){P(this,arguments).event(S).start()}).on("interrupt.zoom end.zoom",function(){P(this,arguments).event(S).end()}).tween("zoom",function(){var E=this,f=arguments,v=P(E,f).event(S),b=n.apply(E,f),z=x==null?T(b):typeof x=="function"?x.apply(E,f):x,L=Math.max(b[1][0]-b[0][0],b[1][1]-b[0][1]),$=E.__zoom,F=typeof C=="function"?C.apply(E,f):C,Q=u($.invert(z).concat(L/$.k),F.invert(z).concat(L/F.k));return function(U){if(U===1)U=F;else{var j=Q(U),Le=L/j[2];U=new J(Le,z[0]-j[0]*Le,z[1]-j[1]*Le)}v.zoom(null,U)}})}function P(m,C,x){return!x&&m.__zooming||new Y(m,C)}function Y(m,C){this.that=m,this.args=C,this.active=0,this.sourceEvent=null,this.extent=n.apply(m,C),this.taps=0}Y.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,C){return this.mouse&&m!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var C=D(this.that).datum();l.call(m,this.that,new mn(m,{sourceEvent:this.sourceEvent,target:_,type:m,transform:this.that.__zoom,dispatch:l}),C)}};function rt(m,...C){if(!e.apply(this,arguments))return;var x=P(this,C).event(m),S=this.__zoom,E=Math.max(o[0],Math.min(o[1],S.k*Math.pow(2,r.apply(this,arguments)))),f=et(m);if(x.wheel)(x.mouse[0][0]!==f[0]||x.mouse[0][1]!==f[1])&&(x.mouse[1]=S.invert(x.mouse[0]=f)),clearTimeout(x.wheel);else{if(S.k===E)return;x.mouse=[f,S.invert(f)],gt(this),x.start()}Et(m),x.wheel=setTimeout(v,g),x.zoom("mouse",t(M(k(S,E),x.mouse[0],x.mouse[1]),x.extent,s));function v(){x.wheel=null,x.end()}}function Mt(m,...C){if(p||!e.apply(this,arguments))return;var x=m.currentTarget,S=P(this,C,!0).event(m),E=D(m.view).on("mousemove.zoom",z,!0).on("mouseup.zoom",L,!0),f=et(m,x),v=m.clientX,b=m.clientY;tn(m.view),$e(m),S.mouse=[f,this.__zoom.invert(f)],gt(this),S.start();function z($){if(Et($),!S.moved){var F=$.clientX-v,Q=$.clientY-b;S.moved=F*F+Q*Q>y}S.event($).zoom("mouse",t(M(S.that.__zoom,S.mouse[0]=et($,x),S.mouse[1]),S.extent,s))}function L($){E.on("mousemove.zoom mouseup.zoom",null),en($.view,S.moved),Et($),S.event($).end()}}function it(m,...C){if(e.apply(this,arguments)){var x=this.__zoom,S=et(m.changedTouches?m.changedTouches[0]:m,this),E=x.invert(S),f=x.k*(m.shiftKey?.5:2),v=t(M(k(x,f),S,E),n.apply(this,C),s);Et(m),a>0?D(this).transition().duration(a).call(B,v,S,m):D(this).call(_.transform,v,S,m)}}function vt(m,...C){if(e.apply(this,arguments)){var x=m.touches,S=x.length,E=P(this,C,m.changedTouches.length===S).event(m),f,v,b,z;for($e(m),v=0;v<S;++v)b=x[v],z=et(b,this),z=[z,this.__zoom.invert(z),b.identifier],E.touch0?!E.touch1&&E.touch0[2]!==z[2]&&(E.touch1=z,E.taps=0):(E.touch0=z,f=!0,E.taps=1+!!c);c&&(c=clearTimeout(c)),f&&(E.taps<2&&(h=z[0],c=setTimeout(function(){c=null},d)),gt(this),E.start())}}function K(m,...C){if(this.__zooming){var x=P(this,C).event(m),S=m.changedTouches,E=S.length,f,v,b,z;for(Et(m),f=0;f<E;++f)v=S[f],b=et(v,this),x.touch0&&x.touch0[2]===v.identifier?x.touch0[0]=b:x.touch1&&x.touch1[2]===v.identifier&&(x.touch1[0]=b);if(v=x.that.__zoom,x.touch1){var L=x.touch0[0],$=x.touch0[1],F=x.touch1[0],Q=x.touch1[1],U=(U=F[0]-L[0])*U+(U=F[1]-L[1])*U,j=(j=Q[0]-$[0])*j+(j=Q[1]-$[1])*j;v=k(v,Math.sqrt(U/j)),b=[(L[0]+F[0])/2,(L[1]+F[1])/2],z=[($[0]+Q[0])/2,($[1]+Q[1])/2]}else if(x.touch0)b=x.touch0[0],z=x.touch0[1];else return;x.zoom("touch",t(M(v,b,z),x.extent,s))}}function Cn(m,...C){if(this.__zooming){var x=P(this,C).event(m),S=m.changedTouches,E=S.length,f,v;for($e(m),p&&clearTimeout(p),p=setTimeout(function(){p=null},d),f=0;f<E;++f)v=S[f],x.touch0&&x.touch0[2]===v.identifier?delete x.touch0:x.touch1&&x.touch1[2]===v.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(v=et(v,this),Math.hypot(h[0]-v[0],h[1]-v[1])<w)){var b=D(this).on("dblclick.zoom");b&&b.apply(this,arguments)}}}return _.wheelDelta=function(m){return arguments.length?(r=typeof m=="function"?m:Gt(+m),_):r},_.filter=function(m){return arguments.length?(e=typeof m=="function"?m:Gt(!!m),_):e},_.touchable=function(m){return arguments.length?(i=typeof m=="function"?m:Gt(!!m),_):i},_.extent=function(m){return arguments.length?(n=typeof m=="function"?m:Gt([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),_):n},_.scaleExtent=function(m){return arguments.length?(o[0]=+m[0],o[1]=+m[1],_):[o[0],o[1]]},_.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],_):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},_.constrain=function(m){return arguments.length?(t=m,_):t},_.duration=function(m){return arguments.length?(a=+m,_):a},_.interpolate=function(m){return arguments.length?(u=m,_):u},_.on=function(){var m=l.on.apply(l,arguments);return m===l?_:m},_.clickDistance=function(m){return arguments.length?(y=(m=+m)*m,_):Math.sqrt(y)},_.tapDistance=function(m){return arguments.length?(w=+m,_):w},_}function Zs(e){var n=0,t=e.children,r=t&&t.length;if(!r)n=1;else for(;--r>=0;)n+=t[r].value;e.value=n}function Gi(){return this.eachAfter(Zs)}function Ji(e){var n=this,t,r=[n],i,o,s;do for(t=r.reverse(),r=[];n=t.pop();)if(e(n),i=n.children,i)for(o=0,s=i.length;o<s;++o)r.push(i[o]);while(r.length);return this}function Zi(e){for(var n=this,t=[n],r,i;n=t.pop();)if(e(n),r=n.children,r)for(i=r.length-1;i>=0;--i)t.push(r[i]);return this}function Ki(e){for(var n=this,t=[n],r=[],i,o,s;n=t.pop();)if(r.push(n),i=n.children,i)for(o=0,s=i.length;o<s;++o)t.push(i[o]);for(;n=r.pop();)e(n);return this}function Qi(e){return this.eachAfter(function(n){for(var t=+e(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)t+=r[i].value;n.value=t})}function ji(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function to(e){for(var n=this,t=Ks(n,e),r=[n];n!==t;)n=n.parent,r.push(n);for(var i=r.length;e!==t;)r.splice(i,0,e),e=e.parent;return r}function Ks(e,n){if(e===n)return e;var t=e.ancestors(),r=n.ancestors(),i=null;for(e=t.pop(),n=r.pop();e===n;)i=e,e=t.pop(),n=r.pop();return i}function eo(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function no(){var e=[];return this.each(function(n){e.push(n)}),e}function ro(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function io(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n}function zt(e,n){var t=new Be(e),r=+e.value&&(t.value=e.value),i,o=[t],s,a,u,l;for(n==null&&(n=js);i=o.pop();)if(r&&(i.value=+i.data.value),(a=n(i.data))&&(l=a.length))for(i.children=new Array(l),u=l-1;u>=0;--u)o.push(s=i.children[u]=new Be(a[u])),s.parent=i,s.depth=i.depth+1;return t.eachBefore(el)}function Qs(){return zt(this).eachBefore(tl)}function js(e){return e.children}function tl(e){e.data=e.data.data}function el(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function Be(e){this.data=e,this.depth=this.height=0,this.parent=null}Be.prototype=zt.prototype={constructor:Be,count:Gi,each:Ji,eachAfter:Ki,eachBefore:Zi,sum:Qi,sort:ji,path:to,ancestors:eo,descendants:no,leaves:ro,links:io,copy:Qs};var oo={name:"d3-flextree",version:"2.1.2",main:"build/d3-flextree.js",module:"index","jsnext:main":"index",author:{name:"Chris Maloney",url:"http://chrismaloney.org"},description:"Flexible tree layout algorithm that allows for variable node sizes.",keywords:["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],homepage:"https://github.com/klortho/d3-flextree",license:"WTFPL",repository:{type:"git",url:"https://github.com/klortho/d3-flextree.git"},scripts:{clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},dependencies:{"d3-hierarchy":"^1.1.5"},devDependencies:{"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"}};var{version:rl}=oo,il=Object.freeze({children:e=>e.children,nodeSize:e=>e.data.size,spacing:0});function Tt(e){let n=Object.assign({},il,e);function t(a){let u=n[a];return typeof u=="function"?u:()=>u}function r(a){let u=s(o(),a,l=>l.children);return u.update(),u.data}function i(){let a=t("nodeSize"),u=t("spacing");return class ao extends zt.prototype.constructor{constructor(c){super(c)}copy(){let c=s(this.constructor,this,h=>h.children);return c.each(h=>h.data=h.data.data),c}get size(){return a(this)}spacing(c){return u(this,c)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){let c=this.ancestors();return c[c.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((c,h)=>ao.maxExtents(c,h.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(c,h){return{top:Math.min(c.top,h.top),bottom:Math.max(c.bottom,h.bottom),left:Math.min(c.left,h.left),right:Math.max(c.right,h.right)}}}}function o(){let a=i(),u=t("nodeSize"),l=t("spacing");return class extends a{constructor(c){super(c),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return u(this.data)}spacing(c){return l(this.data,c.data)}get x(){return this.data.x}set x(c){this.data.x=c}get y(){return this.data.y}set y(c){this.data.y=c}update(){return so(this),lo(this),this}}}function s(a,u,l){let c=(h,p)=>{let d=new a(h);Object.assign(d,{parent:p,depth:p===null?0:p.depth+1,height:0,length:1});let g=l(h)||[];return d.children=g.length===0?null:g.map(y=>c(y,d)),d.children&&Object.assign(d,d.children.reduce((y,w)=>({height:Math.max(y.height,w.height+1),length:y.length+w.length}),d)),d};return c(u,null)}return Object.assign(r,{nodeSize(a){return arguments.length?(n.nodeSize=a,r):n.nodeSize},spacing(a){return arguments.length?(n.spacing=a,r):n.spacing},children(a){return arguments.length?(n.children=a,r):n.children},hierarchy(a,u){let l=typeof u>"u"?n.children:u;return s(i(),a,l)},dump(a){let u=t("nodeSize"),l=c=>h=>{let p=c+"  ",d=c+"    ",{x:g,y}=h,w=u(h),_=h.children||[],k=_.length===0?" ":`,${p}children: [${d}${_.map(l(d)).join(d)}${p}],${c}`;return`{ size: [${w.join(", ")}],${p}x: ${g}, y: ${y}${k}},`};return l(`
`)(a)}}),r}Tt.version=rl;var so=(e,n=0)=>(e.y=n,(e.children||[]).reduce((t,r)=>{let[i,o]=t;so(r,e.y+e.ySize);let s=(i===0?r.lExt:r.rExt).bottom;i!==0&&al(e,i,o);let a=dl(s,i,o);return[i+1,a]},[0,null]),ol(e),pl(e),e),lo=(e,n,t)=>{typeof n>"u"&&(n=-e.relX-e.prelim,t=0);let r=n+e.relX;return e.relX=r+e.prelim-t,e.prelim=0,e.x=t+e.relX,(e.children||[]).forEach(i=>lo(i,r,e.x)),e},ol=e=>{(e.children||[]).reduce((n,t)=>{let[r,i]=n,o=r+t.shift,s=i+o+t.change;return t.relX+=s,[o,s]},[0,0])},al=(e,n,t)=>{let r=e.children[n-1],i=e.children[n],o=r,s=r.relX,a=i,u=i.relX,l=!0;for(;o&&a;){o.bottom>t.lowY&&(t=t.next);let c=s+o.prelim-(u+a.prelim)+o.xSize/2+a.xSize/2+o.spacing(a);(c>0||c<0&&l)&&(u+=c,sl(i,c),ll(e,n,t.index,c)),l=!1;let h=o.bottom,p=a.bottom;h<=p&&(o=cl(o),o&&(s+=o.relX)),h>=p&&(a=ul(a),a&&(u+=a.relX))}!o&&a?fl(e,n,a,u):o&&!a&&hl(e,n,o,s)},sl=(e,n)=>{e.relX+=n,e.lExtRelX+=n,e.rExtRelX+=n},ll=(e,n,t,r)=>{let i=e.children[n],o=n-t;if(o>1){let s=r/o;e.children[t+1].shift+=s,i.shift-=s,i.change-=r-s}},ul=e=>e.hasChildren?e.firstChild:e.lThr,cl=e=>e.hasChildren?e.lastChild:e.rThr,fl=(e,n,t,r)=>{let i=e.firstChild,o=i.lExt,s=e.children[n];o.lThr=t;let a=r-t.relX-i.lExtRelX;o.relX+=a,o.prelim-=a,i.lExt=s.lExt,i.lExtRelX=s.lExtRelX},hl=(e,n,t,r)=>{let i=e.children[n],o=i.rExt,s=e.children[n-1];o.rThr=t;let a=r-t.relX-i.rExtRelX;o.relX+=a,o.prelim-=a,i.rExt=s.rExt,i.rExtRelX=s.rExtRelX},pl=e=>{if(e.hasChildren){let n=e.firstChild,t=e.lastChild,r=(n.prelim+n.relX-n.xSize/2+t.relX+t.prelim+t.xSize/2)/2;Object.assign(e,{prelim:r,lExt:n.lExt,lExtRelX:n.lExtRelX,rExt:t.rExt,rExtRelX:t.rExtRelX})}},dl=(e,n,t)=>{for(;t!==null&&e>=t.lowY;)t=t.next;return{lowY:e,index:n,next:t}};function yn(e){return function(){return e}}var _n=Math.PI,vn=2*_n,yt=1e-6,ml=vn-yt;function uo(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function gl(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return uo;let t=10**n;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*t)/t+r[i]}}var _t=class{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?uo:gl(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,r,i){this._append`Q${+n},${+t},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(n,t,r,i,o,s){this._append`C${+n},${+t},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(n,t,r,i,o){if(n=+n,t=+t,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=r-n,l=i-t,c=s-n,h=a-t,p=c*c+h*h;if(this._x1===null)this._append`M${this._x1=n},${this._y1=t}`;else if(p>yt)if(!(Math.abs(h*u-l*c)>yt)||!o)this._append`L${this._x1=n},${this._y1=t}`;else{let d=r-s,g=i-a,y=u*u+l*l,w=d*d+g*g,_=Math.sqrt(y),k=Math.sqrt(p),M=o*Math.tan((_n-Math.acos((y+p-w)/(2*_*k)))/2),T=M/k,B=M/_;Math.abs(T-1)>yt&&this._append`L${n+T*c},${t+T*h}`,this._append`A${o},${o},0,0,${+(h*d>c*g)},${this._x1=n+B*u},${this._y1=t+B*l}`}}arc(n,t,r,i,o,s){if(n=+n,t=+t,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),u=r*Math.sin(i),l=n+a,c=t+u,h=1^s,p=s?i-o:o-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>yt||Math.abs(this._y1-c)>yt)&&this._append`L${l},${c}`,r&&(p<0&&(p=p%vn+vn),p>ml?this._append`A${r},${r},0,1,${h},${n-a},${t-u}A${r},${r},0,1,${h},${this._x1=l},${this._y1=c}`:p>yt&&this._append`A${r},${r},0,${+(p>=_n)},${h},${this._x1=n+r*Math.cos(o)},${this._y1=t+r*Math.sin(o)}`)}rect(n,t,r,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function co(){return new _t}co.prototype=_t.prototype;function fo(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{let r=Math.floor(t);if(!(r>=0))throw new RangeError(`invalid digits: ${t}`);n=r}return e},()=>new _t(n)}var ho=Array.prototype.slice;function po(e){return e[0]}function mo(e){return e[1]}var wn=class{constructor(n,t){this._context=n,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,t){switch(n=+n,t=+t,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,t):this._context.moveTo(n,t);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,t,n,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,n,this._y0,n,t);break}}this._x0=n,this._y0=t}};function go(e){return new wn(e,!0)}function xl(e){return e.source}function yl(e){return e.target}function xo(e){let n=xl,t=yl,r=po,i=mo,o=null,s=null,a=fo(u);function u(){let l,c=ho.call(arguments),h=n.apply(this,c),p=t.apply(this,c);if(o==null&&(s=e(l=a())),s.lineStart(),c[0]=h,s.point(+r.apply(this,c),+i.apply(this,c)),c[0]=p,s.point(+r.apply(this,c),+i.apply(this,c)),s.lineEnd(),l)return s=null,l+""||null}return u.source=function(l){return arguments.length?(n=l,u):n},u.target=function(l){return arguments.length?(t=l,u):t},u.x=function(l){return arguments.length?(r=typeof l=="function"?l:yn(+l),u):r},u.y=function(l){return arguments.length?(i=typeof l=="function"?l:yn(+l),u):i},u.context=function(l){return arguments.length?(l==null?o=s=null:s=e(o=l),u):o},u}function bn(){return xo(go)}var N={selection:W,select:D,max:re,min:ie,sum:oe,cumsum:ne,tree:je,stratify:Ze,zoom:xn,zoomIdentity:xt,linkHorizontal:bn,flextree:Tt},yo=class{constructor(){let n={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:t=>t.nodeId||t.id,parentNodeId:t=>t.parentNodeId||t.parentId,rootMargin:40,nodeWidth:t=>250,nodeHeight:t=>150,neighbourMargin:(t,r)=>80,siblingsMargin:t=>20,childrenMargin:t=>60,compactMarginPair:t=>100,compactMarginBetween:t=>20,nodeButtonWidth:t=>40,nodeButtonHeight:t=>40,nodeButtonX:t=>-20,nodeButtonY:t=>-20,linkYOffset:30,pagingStep:t=>5,minPagingVisibleNodes:t=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:t=>N.zoom(),onZoomStart:t=>{},onZoom:t=>{},onZoomEnd:t=>{},onNodeClick:t=>t,onExpandOrCollapse:t=>t,nodeContent:t=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${t.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:t,state:r})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,bottom:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>
                    `,right:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,top:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>
                    `}[r.layout](t.children)}  </div>`,pagingButton:(t,r,i,o)=>{let s=o.pagingStep(t.parent),a=t.parent.data._pagingStep,u=t.parent.data._directSubordinatesPaging-a;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(u,s)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(t,r,i){N.select(this).select(".node-rect").attr("stroke",o=>o.data._highlighted||o.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",t.data._highlighted||t.data._upToTheRootHighlighted?10:1)},nodeEnter:t=>t,nodeExit:t=>t,linkUpdate:function(t,r,i){N.select(this).attr("stroke",o=>o.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",o=>o.data._upToTheRootHighlighted?5:1),t.data._upToTheRootHighlighted&&N.select(this).raise()},hdiagonal:function(t,r,i){let o=t.x,s=t.y,a=r.x,u=r.y,l=i&&i.x!=null?i.x:o,c=i&&i.y!=null?i.y:s,h=a-o<0?-1:1,p=u-s<0?-1:1,d=35,g=Math.abs(a-o)/2<d?Math.abs(a-o)/2:d;g=Math.abs(u-s)/2<g?Math.abs(u-s)/2:g;let y=Math.abs(u-s)/2-g,w=Math.abs(a-o)/2-g;return`
                          M ${l} ${c}
                          L ${l} ${s}
                          L ${o} ${s}
                          L ${o+w*h} ${s}
                          C ${o+w*h+g*h} ${s} 
                            ${o+w*h+g*h} ${s} 
                            ${o+w*h+g*h} ${s+g*p}
                          L ${o+w*h+g*h} ${u-g*p} 
                          C ${o+w*h+g*h}  ${u} 
                            ${o+w*h+g*h}  ${u} 
                            ${a-w*h}  ${u}
                          L ${a} ${u}
               `},diagonal:function(t,r,i,o={sy:0}){let s=t.x,a=t.y,u=r.x,l=r.y,c=i&&i.x!=null?i.x:s,h=i&&i.y!=null?i.y:a,p=u-s<0?-1:1,d=l-a<0?-1:1;a+=o.sy;let g=35,y=Math.abs(u-s)/2<g?Math.abs(u-s)/2:g;y=Math.abs(l-a)/2<y?Math.abs(l-a)/2:y;let w=Math.abs(l-a)/2-y,_=Math.abs(u-s)-y*2;return`
                          M ${c} ${h}
                          L ${s} ${h}
                          L ${s} ${a}
                          L ${s} ${a+w*d}
                          C  ${s} ${a+w*d+y*d} ${s} ${a+w*d+y*d} ${s+y*p} ${a+w*d+y*d}
                          L ${s+_*p+y*p} ${a+w*d+y*d}
                          C  ${u}  ${a+w*d+y*d} ${u}  ${a+w*d+y*d} ${u} ${l-w*d}
                          L ${u} ${l}
               `},defs:function(t,r){return`<defs>
                    ${r.map(i=>{let o=this.getTextWidth(i.label,{ctx:t.ctx,fontSize:2,defaultFont:t.defaultFont});return`
                       <marker id="${i.from+"_"+i.to}" refX="${i._source.x<i._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${i._source.x<i._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${i.label?o+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${i.label||""}</text>
                       </marker>

                       <marker id="arrow-${i.from+"_"+i.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${i._source.x<i._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(t,r,i){N.select(this).attr("stroke",o=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",o=>"5").attr("pointer-events","none").attr("marker-start",o=>`url(#${o.from+"_"+o.to})`).attr("marker-end",o=>`url(#arrow-${o.from+"_"+o.to})`)},linkGroupArc:N.linkHorizontal().x(t=>t.x).y(t=>t.y),layoutBindings:{left:{nodeLeftX:t=>0,nodeRightX:t=>t.width,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x+t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x+t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkCompactXStart:t=>t.x+t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,r)=>t.firstCompactNode.x,compactLinkMidY:(t,r)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,linkParentX:t=>t.parent.x+t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>t.width,buttonY:t=>t.height/2,centerTransform:({root:t,rootMargin:r,centerY:i,scale:o,centerX:s})=>`translate(${r},${i}) scale(${o})`,compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},nodeFlexSize:({height:t,width:r,siblingsMargin:i,childrenMargin:o,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[t+i,r+o],zoomTransform:({centerY:t,scale:r})=>`translate(0,${t}) scale(${r})`,diagonal:this.hdiagonal.bind(this),swap:t=>{let r=t.x;t.x=t.y,t.y=r},nodeUpdateTransform:({x:t,y:r,width:i,height:o})=>`translate(${t},${r-o/2})`},top:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>0,nodeBottomY:t=>t.height,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y+t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y+t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y+t.height/2,compactLinkMidX:(t,r)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y+t.parent.height,buttonX:t=>t.width/2,buttonY:t=>t.height,centerTransform:({root:t,rootMargin:r,centerY:i,scale:o,centerX:s})=>`translate(${s},${r}) scale(${o})`,nodeFlexSize:({height:t,width:r,siblingsMargin:i,childrenMargin:o,state:s,node:a,compactViewIndex:u})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[r+i,t+o],zoomTransform:({centerX:t,scale:r})=>`translate(${t},0}) scale(${r})`,diagonal:this.diagonal.bind(this),swap:t=>{},nodeUpdateTransform:({x:t,y:r,width:i,height:o})=>`translate(${t-i/2},${r})`},bottom:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>-t.height,nodeBottomY:t=>0,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y-t.height-t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y-t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y-t.height/2,compactLinkMidX:(t,r)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,linkX:t=>t.x,linkY:t=>t.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y-t.parent.height,buttonX:t=>t.width/2,buttonY:t=>0,centerTransform:({root:t,rootMargin:r,centerY:i,scale:o,centerX:s,chartHeight:a})=>`translate(${s},${a-r}) scale(${o})`,nodeFlexSize:({height:t,width:r,siblingsMargin:i,childrenMargin:o,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[r+i,t+o],zoomTransform:({centerX:t,scale:r})=>`translate(${t},0}) scale(${r})`,diagonal:this.diagonal.bind(this),swap:t=>{t.y=-t.y},nodeUpdateTransform:({x:t,y:r,width:i,height:o})=>`translate(${t-i/2},${r-o})`},right:{nodeLeftX:t=>-t.width,nodeRightX:t=>0,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x-t.width-t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x-t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x-t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>0,buttonY:t=>t.height/2,linkCompactXStart:t=>t.x-t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,r)=>t.firstCompactNode.x,compactLinkMidY:(t,r)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+r.compactMarginPair(t)/4,centerTransform:({root:t,rootMargin:r,centerY:i,scale:o,centerX:s,chartWidth:a})=>`translate(${a-r},${i}) scale(${o})`,nodeFlexSize:({height:t,width:r,siblingsMargin:i,childrenMargin:o,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[t+i,r+o],compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},zoomTransform:({centerY:t,scale:r})=>`translate(0,${t}) scale(${r})`,diagonal:this.hdiagonal.bind(this),swap:t=>{let r=t.x;t.x=-t.y,t.y=r},nodeUpdateTransform:({x:t,y:r,width:i,height:o})=>`translate(${t-i},${r-o/2})`}}};this.getChartState=()=>n,Object.keys(n).forEach(t=>{this[t]=function(r){if(arguments.length)n[t]=r;else return n[t];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){N.selection.prototype.patternify=function(n){var t=this,r=n.selector,i=n.tag,o=n.data||[r],s=t.selectAll("."+r).data(o,(a,u)=>typeof a=="object"&&a.id?a.id:u);return s.exit().remove(),s=s.enter().append(i).merge(s),s.attr("class",r),s}}getNodeChildren({data:n,children:t,_children:r},i){return i.push(n),t&&t.forEach(o=>{this.getNodeChildren(o,i)}),r&&r.forEach(o=>{this.getNodeChildren(o,i)}),i}initialZoom(n){let t=this.getChartState();return t.lastTransform.k=n,this}render(){let n=this.getChartState();if(!n.data||n.data.length==0)return console.log("ORG CHART - Data is empty"),n.container&&(D(n.container).select(".nodes-wrapper").remove(),D(n.container).select(".links-wrapper").remove(),D(n.container).select(".connections-wrapper").remove()),this;let t=N.select(n.container),r=t.node().getBoundingClientRect();r.width>0&&(n.svgWidth=r.width);let i={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:n.svgWidth,chartHeight:n.svgHeight};if(n.calc=i,i.centerX=i.chartWidth/2,i.centerY=i.chartHeight/2,n.firstDraw){let a={zoom:null};a.zoom=n.createZoom().clickDistance(10).on("start",(u,l)=>n.onZoomStart(u)).on("end",(u,l)=>n.onZoomEnd(u)).on("zoom",(u,l)=>{n.onZoom(u),this.zoomed(u,l)}).scaleExtent(n.scaleExtent),n.zoomBehavior=a.zoom}n.flexTreeLayout=Tt({nodeSize:a=>{let u=n.nodeWidth(a),l=n.nodeHeight(a),c=n.siblingsMargin(a),h=n.childrenMargin(a);return n.layoutBindings[n.layout].nodeFlexSize({state:n,node:a,width:u,height:l,siblingsMargin:c,childrenMargin:h})}}).spacing((a,u)=>a.parent==u.parent?0:n.neighbourMargin(a,u)),this.setLayouts({expandNodesFirst:!1});let o=t.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",n.svgWidth).attr("height",n.svgHeight).attr("font-family",n.defaultFont);n.firstDraw&&o.call(n.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),n.svg=o;let s=o.patternify({tag:"g",selector:"chart"});return n.centerG=s.patternify({tag:"g",selector:"center-group"}),n.linksWrapper=n.centerG.patternify({tag:"g",selector:"links-wrapper"}),n.nodesWrapper=n.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),n.connectionsWrapper=n.centerG.patternify({tag:"g",selector:"connections-wrapper"}),n.defsWrapper=o.patternify({tag:"g",selector:"defs-wrapper"}),n.firstDraw&&n.centerG.attr("transform",()=>n.layoutBindings[n.layout].centerTransform({centerX:i.centerX,centerY:i.centerY,scale:n.lastTransform.k,rootMargin:n.rootMargin,root:n.root,chartHeight:i.chartHeight,chartWidth:i.chartWidth})),n.chart=s,this.update(n.root),N.select(window).on(`resize.${n.id}`,()=>{let a=N.select(n.container).node().getBoundingClientRect();n.svg.attr("width",a.width)}),n.firstDraw&&(n.firstDraw=!1),this}addNode(n){let t=this.getChartState();if(n&&(t.parentNodeId(n)==null||t.parentNodeId(n)==t.nodeId(n))&&t.data.length==0)return t.data.push(n),this.render(),this;let i=t.generateRoot(t.data).descendants(),o=i.filter(({data:a})=>t.nodeId(a).toString()===t.nodeId(n).toString())[0],s=i.filter(({data:a})=>t.nodeId(a).toString()===t.parentNodeId(n).toString())[0];return o?(console.log(`ORG CHART - ADD - Node with id "${t.nodeId(n)}" already exists in tree`),this):(n._centered&&!n._expanded&&(n._expanded=!0),t.data.push(n),this.updateNodesState(),this)}removeNode(n){let t=this.getChartState(),o=t.generateRoot(t.data).descendants().filter(({data:a})=>t.nodeId(a)==n)[0];return o?(o.descendants().forEach(a=>a.data._filteredOut=!0),t.data=t.data.filter(a=>!a._filteredOut),t.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${n}" not found in the tree`),this)}groupBy(n,t,r){let i={};return n.forEach(o=>{let s=t(o);i[s]||(i[s]=[]),i[s].push(o)}),Object.keys(i).forEach(o=>{i[o]=r(i[o])}),Object.entries(i)}calculateCompactFlexDimensions(n){let t=this.getChartState();n.eachBefore(r=>{r.firstCompact=null,r.compactEven=null,r.flexCompactDim=null,r.firstCompactNode=null}),n.eachBefore(r=>{if(r.children&&r.children.length>1){let i=r.children.filter(c=>!c.children);if(i.length<2)return;i.forEach((c,h)=>{h||(c.firstCompact=!0),h%2?c.compactEven=!1:c.compactEven=!0,c.row=Math.floor(h/2)});let o=N.max(i.filter(c=>c.compactEven),t.layoutBindings[t.layout].compactDimension.sizeColumn),s=N.max(i.filter(c=>!c.compactEven),t.layoutBindings[t.layout].compactDimension.sizeColumn),a=Math.max(o,s)*2,u=this.groupBy(i,c=>c.row,c=>N.max(c,h=>t.layoutBindings[t.layout].compactDimension.sizeRow(h)+t.compactMarginBetween(h))),l=N.sum(u.map(c=>c[1]));i.forEach(c=>{c.firstCompactNode=i[0],c.firstCompact?c.flexCompactDim=[a+t.compactMarginPair(c),l-t.compactMarginBetween(c)]:c.flexCompactDim=[0,0]}),r.flexCompactDim=null}})}calculateCompactFlexPositions(n){let t=this.getChartState();n.eachBefore(r=>{if(r.children){let i=r.children.filter(c=>c.flexCompactDim),o=i[0];if(!o)return;i.forEach((c,h,p)=>{h==0&&(o.x-=o.flexCompactDim[0]/2),h&h%2-1?c.x=o.x+o.flexCompactDim[0]*.25-t.compactMarginPair(c)/4:h&&(c.x=o.x+o.flexCompactDim[0]*.75+t.compactMarginPair(c)/4)});let s=o.x+o.flexCompactDim[0]*.5;o.x=o.x+o.flexCompactDim[0]*.25-t.compactMarginPair(o)/4;let a=r.x-s;Math.abs(a)<10&&i.forEach(c=>c.x+=a);let u=this.groupBy(i,c=>c.row,c=>N.max(c,h=>t.layoutBindings[t.layout].compactDimension.sizeRow(h))),l=N.cumsum(u.map(c=>c[1]+t.compactMarginBetween(c)));i.forEach((c,h)=>{c.row?c.y=o.y+l[c.row-1]:c.y=o.y})}})}update({x0:n,y0:t,x:r=0,y:i=0,width:o,height:s}){let a=this.getChartState(),u=a.calc;a.compact&&this.calculateCompactFlexDimensions(a.root);let l=a.flexTreeLayout(a.root);a.compact&&this.calculateCompactFlexPositions(a.root);let c=l.descendants(),h=l.descendants().slice(1);c.forEach(a.layoutBindings[a.layout].swap);let p=a.connections,d={};a.allNodes.forEach(f=>d[a.nodeId(f.data)]=f);let g={};c.forEach(f=>g[a.nodeId(f.data)]=f),p.forEach(f=>{let v=d[f.from],b=d[f.to];f._source=v,f._target=b});let y=p.filter(f=>g[f.from]&&g[f.to]),w=a.defs.bind(this)(a,y),_=a.defsWrapper.html();w!==_&&a.defsWrapper.html(w);let k=a.linksWrapper.selectAll("path.link").data(h,f=>a.nodeId(f.data)),T=k.enter().insert("path","g").attr("class","link").attr("d",f=>{let v=a.layoutBindings[a.layout].linkJoinX({x:n,y:t,width:o,height:s}),b=a.layoutBindings[a.layout].linkJoinY({x:n,y:t,width:o,height:s}),z={x:v,y:b};return a.layoutBindings[a.layout].diagonal(z,z,z)}).merge(k);T.attr("fill","none"),this.isEdge()?T.style("display",f=>f.data._pagingButton?"none":"auto"):T.attr("display",f=>f.data._pagingButton?"none":"auto"),T.each(a.linkUpdate),T.transition().duration(a.duration).attr("d",f=>{let v=a.compact&&f.flexCompactDim?{x:a.layoutBindings[a.layout].compactLinkMidX(f,a),y:a.layoutBindings[a.layout].compactLinkMidY(f,a)}:{x:a.layoutBindings[a.layout].linkX(f),y:a.layoutBindings[a.layout].linkY(f)},b={x:a.layoutBindings[a.layout].linkParentX(f),y:a.layoutBindings[a.layout].linkParentY(f)},z=a.compact&&f.flexCompactDim?{x:a.layoutBindings[a.layout].linkCompactXStart(f),y:a.layoutBindings[a.layout].linkCompactYStart(f)}:v;return a.layoutBindings[a.layout].diagonal(v,b,z,{sy:a.linkYOffset})});let B=k.exit().transition().duration(a.duration).attr("d",f=>{let v=a.layoutBindings[a.layout].linkJoinX({x:r,y:i,width:o,height:s}),b=a.layoutBindings[a.layout].linkJoinY({x:r,y:i,width:o,height:s}),z={x:v,y:b};return a.layoutBindings[a.layout].diagonal(z,z,null,{sy:a.linkYOffset})}).remove(),P=a.connectionsWrapper.selectAll("path.connection").data(y),rt=P.enter().insert("path","g").attr("class","connection").attr("d",f=>{let v=a.layoutBindings[a.layout].linkJoinX({x:n,y:t,width:o,height:s}),b=a.layoutBindings[a.layout].linkJoinY({x:n,y:t,width:o,height:s}),z={x:v,y:b};return a.layoutBindings[a.layout].diagonal(z,z,null,{sy:a.linkYOffset})}).merge(P);rt.attr("fill","none"),rt.transition().duration(a.duration).attr("d",f=>{let v=a.layoutBindings[a.layout].linkX({x:f._source.x,y:f._source.y,width:f._source.width,height:f._source.height}),b=a.layoutBindings[a.layout].linkY({x:f._source.x,y:f._source.y,width:f._source.width,height:f._source.height}),z=a.layoutBindings[a.layout].linkJoinX({x:f._target.x,y:f._target.y,width:f._target.width,height:f._target.height}),L=a.layoutBindings[a.layout].linkJoinY({x:f._target.x,y:f._target.y,width:f._target.width,height:f._target.height});return a.linkGroupArc({source:{x:v,y:b},target:{x:z,y:L}})}),rt.each(a.connectionsUpdate);let Mt=P.exit().transition().duration(a.duration).attr("opacity",0).remove(),it=a.nodesWrapper.selectAll("g.node").data(c,({data:f})=>a.nodeId(f)),vt=it.enter().append("g").attr("class","node").attr("transform",f=>{if(f==a.root)return`translate(${n},${t})`;let v=a.layoutBindings[a.layout].nodeJoinX({x:n,y:t,width:o,height:s}),b=a.layoutBindings[a.layout].nodeJoinY({x:n,y:t,width:o,height:s});return`translate(${v},${b})`}).attr("cursor","pointer").on("click.node",(f,v)=>{let{data:b}=v;if(![...f.srcElement.classList].includes("node-button-foreign-object")){if([...f.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(v);return}if(!b._pagingButton){a.onNodeClick(v);return}console.log("event fired, no handlers")}}).on("keydown.node",(f,v)=>{let{data:b}=v;if(f.key==="Enter"||f.key===" "||f.key==="Spacebar"){if([...f.srcElement.classList].includes("node-button-foreign-object"))return;if([...f.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(v);return}(f.key==="Enter"||f.key===" "||f.key==="Spacebar")&&this.onButtonClick(f,v)}});vt.each(a.nodeEnter),vt.patternify({tag:"rect",selector:"node-rect",data:f=>[f]});let K=vt.merge(it).style("font","12px sans-serif");K.patternify({tag:"foreignObject",selector:"node-foreign-object",data:f=>[f]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:f=>[f]}),this.restyleForeignObjectElements();let m=vt.patternify({tag:"g",selector:"node-button-g",data:f=>[f]}).on("click",(f,v)=>this.onButtonClick(f,v)).on("keydown",(f,v)=>{(f.key==="Enter"||f.key===" "||f.key==="Spacebar")&&this.onButtonClick(f,v)});m.patternify({tag:"rect",selector:"node-button-rect",data:f=>[f]}).attr("opacity",0).attr("pointer-events","all").attr("width",f=>a.nodeButtonWidth(f)).attr("height",f=>a.nodeButtonHeight(f)).attr("x",f=>a.nodeButtonX(f)).attr("y",f=>a.nodeButtonY(f));let C=m.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:f=>[f]}).attr("width",f=>a.nodeButtonWidth(f)).attr("height",f=>a.nodeButtonHeight(f)).attr("x",f=>a.nodeButtonX(f)).attr("y",f=>a.nodeButtonY(f)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:f=>[f]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%");K.transition().attr("opacity",0).duration(a.duration).attr("transform",({x:f,y:v,width:b,height:z})=>a.layoutBindings[a.layout].nodeUpdateTransform({x:f,y:v,width:b,height:z})).attr("opacity",1),K.select(".node-rect").attr("width",({width:f})=>f).attr("height",({height:f})=>f).attr("x",({width:f})=>0).attr("y",({height:f})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",a.nodeDefaultBackground),K.select(".node-button-g").attr("transform",({data:f,width:v,height:b})=>{let z=a.layoutBindings[a.layout].buttonX({width:v,height:b}),L=a.layoutBindings[a.layout].buttonY({width:v,height:b});return`translate(${z},${L})`}).attr("display",({data:f})=>f._directSubordinates>0?null:"none").attr("opacity",({data:f,children:v,_children:b})=>f._pagingButton?0:v||b?1:0),K.select(".node-button-foreign-object .node-button-div").html(f=>a.buttonContent({node:f,state:a})),K.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:f})=>f?40:26).text(({children:f})=>f?"-":"+").attr("y",this.isEdge()?10:0),K.each(a.nodeUpdate);let x=it.exit();x.each(a.nodeExit);let S=x.data().reduce((f,v)=>f.depth<v.depth?f:v,{depth:1/0});x.attr("opacity",1).transition().duration(a.duration).attr("transform",f=>{let{x:v,y:b,width:z,height:L}=S.parent||{},$=a.layoutBindings[a.layout].nodeJoinX({x:v,y:b,width:z,height:L}),F=a.layoutBindings[a.layout].nodeJoinY({x:v,y:b,width:z,height:L});return`translate(${$},${F})`}).on("end",function(){N.select(this).remove()}).attr("opacity",0),c.forEach(f=>{f.x0=f.x,f.y0=f.y});let E=a.allNodes.filter(f=>f.data._centered)[0];if(E){let f=[E];E.data._centeredWithDescendants&&(a.compact?f=E.descendants().filter((v,b)=>b<7):f=E.descendants().filter((v,b,z)=>{let L=Math.round(z.length/2),$=2;return z.length%2?b>L-$&&b<L+$-1:b>L-$&&b<L+$})),E.data._centeredWithDescendants=null,E.data._centered=null,this.fit({animate:!0,scale:!1,nodes:f})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(n,t,r,i){return this.getChartState().hdiagonal(n,t,r,i)}diagonal(n,t,r,i){return this.getChartState().diagonal(n,t,r,i)}restyleForeignObjectElements(){let n=this.getChartState();n.svg.selectAll(".node-foreign-object").attr("width",({width:t})=>t).attr("height",({height:t})=>t).attr("x",({width:t})=>0).attr("y",({height:t})=>0),n.svg.selectAll(".node-foreign-object-div").style("width",({width:t})=>`${t}px`).style("height",({height:t})=>`${t}px`).html(function(t,r,i){return t.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${n.pagingButton(t,r,i,n)}</div></div>`:n.nodeContent.bind(this)(t,r,i,n)})}onButtonClick(n,t){let r=this.getChartState();t.data._pagingButton||(r.setActiveNodeCentered&&(t.data._centered=!0,t.data._centeredWithDescendants=!0),t.children?(t._children=t.children,t.children=null,this.setExpansionFlagToChildren(t,!1)):(t.children=t._children,t._children=null,t.children&&t.children.forEach(({data:i})=>i._expanded=!0)),this.update(t),n.stopPropagation(),r.onExpandOrCollapse(t))}setExpansionFlagToChildren({data:n,children:t,_children:r},i){n._expanded=i,t&&t.forEach(o=>{this.setExpansionFlagToChildren(o,i)}),r&&r.forEach(o=>{this.setExpansionFlagToChildren(o,i)})}expandSomeNodes(n){if(n.data._expanded){let t=n.parent;for(;t&&t._children;)t.children=t._children,t._children=null,t=t.parent}n._children&&n._children.forEach(t=>this.expandSomeNodes(t)),n.children&&n.children.forEach(t=>this.expandSomeNodes(t))}updateNodesState(){let n=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(n.root)}setLayouts({expandNodesFirst:n=!0}){let t=this.getChartState();t.generateRoot=N.stratify().id(o=>t.nodeId(o)).parentId(o=>t.parentNodeId(o)),t.root=t.generateRoot(t.data);let r=t.root.descendants();t.initialExpandLevel>1&&r.length>0&&(r.forEach(o=>{o.depth<=t.initialExpandLevel&&(o.data._expanded=!0)}),t.initialExpandLevel=1);let i={};t.root.descendants().filter(o=>o.children).filter(o=>!o.data._pagingStep).forEach(o=>{o.data._pagingStep=t.minPagingVisibleNodes(o)}),t.root.eachBefore((o,s)=>{o.data._directSubordinatesPaging=o.children?o.children.length:0,o.children&&o.children.forEach((a,u)=>{if(a.data._pagingButton=!1,u>o.data._pagingStep&&(i[a.id]=!0),u===o.data._pagingStep&&o.children.length-1>o.data._pagingStep&&(a.data._pagingButton=!0),i[a.parent.id]&&(i[a.id]=!0),a.data._expanded||a.data._centered||a.data._highlighted||a.data._upToTheRootHighlighted){let l=a;for(;l&&(i[l.id]||l.data._pagingButton);)i[l.id]=!1,l.data._pagingButton&&(l.data._pagingButton=!1,l.parent.children.forEach(c=>{c.data._expanded=!0,i[c.id]=!1})),l=l.parent}})}),t.root=N.stratify().id(o=>t.nodeId(o)).parentId(o=>t.parentNodeId(o))(t.data.filter(o=>i[o.id]!==!0)),t.root.each((o,s,a)=>{let u=o._hierarchyHeight||o.height,l=t.nodeWidth(o),c=t.nodeHeight(o);Object.assign(o,{width:l,height:c,_hierarchyHeight:u})}),t.root.x0=0,t.root.y0=0,t.allNodes=t.root.descendants(),t.allNodes.forEach(o=>{Object.assign(o.data,{_directSubordinates:o.children?o.children.length:0,_totalSubordinates:o.descendants().length-1})}),t.root.children&&(n&&t.root.children.forEach(this.expand),t.root.children.forEach(o=>this.collapse(o)),t.initialExpandLevel==0&&(t.root._children=t.root.children,t.root.children=null),[t.root].forEach(o=>this.expandSomeNodes(o)))}collapse(n){n.children&&(n._children=n.children,n._children.forEach(t=>this.collapse(t)),n.children=null)}expand(n){n._children&&(n.children=n._children,n.children.forEach(t=>this.expand(t)),n._children=null)}zoomed(n,t){let r=this.getChartState(),i=r.chart,o=n.transform;r.lastTransform=o,i.attr("transform",o),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:n,x1:t,y0:r,y1:i,params:o={animate:!0,scale:!0,onCompleted:()=>{}}}){let{centerG:s,svgWidth:a,svgHeight:u,svg:l,zoomBehavior:c,duration:h,lastTransform:p}=this.getChartState(),d=Math.min(8,.9/Math.max((t-n)/a,(i-r)/u)),g=N.zoomIdentity.translate(a/2,u/2);g=g.scale(o.scale?d:p.k),g=g.translate(-(n+t)/2,-(r+i)/2),l.transition().duration(o.animate?h:0).call(c.transform,g),s.transition().duration(o.animate?h:0).attr("transform","translate(0,0)").on("end",function(){o.onCompleted&&o.onCompleted()})}fit({animate:n=!0,nodes:t,scale:r=!0,onCompleted:i=()=>{}}={}){let o=this.getChartState(),{root:s}=o,a=t||s.descendants(),u=N.min(a,p=>p.x+o.layoutBindings[o.layout].nodeLeftX(p)),l=N.max(a,p=>p.x+o.layoutBindings[o.layout].nodeRightX(p)),c=N.min(a,p=>p.y+o.layoutBindings[o.layout].nodeTopY(p)),h=N.max(a,p=>p.y+o.layoutBindings[o.layout].nodeBottomY(p));return this.zoomTreeBounds({params:{animate:n,scale:r,onCompleted:i},x0:u-50,x1:l+50,y0:c-50,y1:h+50}),this}loadPagingNodes(n){let t=this.getChartState();n.data._pagingButton=!1;let r=n.parent.data._pagingStep,i=t.pagingStep(n.parent),o=r+i;n.parent.data._pagingStep=o,this.updateNodesState()}setExpanded(n,t=!0){let r=this.getChartState(),i=r.allNodes.filter(({data:o})=>r.nodeId(o)==n)[0];if(!i)return console.log(`ORG CHART - ${t?"EXPAND":"COLLAPSE"} - Node with id (${n})  not found in the tree`),this;if(i.data._expanded=t,t==!1){let o=i.parent||{descendants:()=>[]};o.descendants().filter(a=>a!=o).forEach(a=>a.data._expanded=!1)}return this}setCentered(n){let t=this.getChartState(),o=t.generateRoot(t.data).descendants().filter(({data:a})=>t.nodeId(a).toString()==n.toString())[0];return o?(o.ancestors().forEach(a=>a.data._expanded=!0),o.data._centered=!0,o.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${n}) not found in the tree`),this)}setHighlighted(n){let t=this.getChartState(),o=t.generateRoot(t.data).descendants().filter(a=>t.nodeId(a.data).toString()===n.toString())[0];return o?(o.ancestors().forEach(a=>a.data._expanded=!0),o.data._highlighted=!0,o.data._expanded=!0,o.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${n})  not found in the tree`),this)}setUpToTheRootHighlighted(n){let t=this.getChartState(),o=t.generateRoot(t.data).descendants().filter(a=>t.nodeId(a.data).toString()===n.toString())[0];return o?(o.ancestors().forEach(a=>a.data._expanded=!0),o.data._upToTheRootHighlighted=!0,o.data._expanded=!0,o.ancestors().forEach(a=>a.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${n}) not found in the tree`),this)}clearHighlighting(){let n=this.getChartState();return n.allNodes.forEach(t=>{t.data._highlighted=!1,t.data._upToTheRootHighlighted=!1}),this.update(n.root),this}fullscreen(n){let t=this.getChartState(),r=N.select(n||t.container).node();N.select(document).on("fullscreenchange."+t.id,function(i){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==r?setTimeout(s=>{t.svg.attr("height",window.innerHeight-40)},500):t.svg.attr("height",t.svgHeight)}),r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():r.msRequestFullscreen&&r.msRequestFullscreen()}zoomIn(){let{svg:n,zoomBehavior:t}=this.getChartState();n.transition().call(t.scaleBy,1.3)}zoomOut(){let{svg:n,zoomBehavior:t}=this.getChartState();n.transition().call(t.scaleBy,.78)}toDataURL(n,t){var r=new XMLHttpRequest;r.onload=function(){var i=new FileReader;i.onloadend=function(){t(i.result)},i.readAsDataURL(r.response)},r.open("GET",n),r.responseType="blob",r.send()}exportImg({full:n=!1,scale:t=3,onLoad:r=s=>s,save:i=!0,backgroundColor:o="#FAFAFA"}={}){let s=this,a=this.getChartState(),{svg:u,root:l}=a,c=0,h=u.selectAll("img"),p=h.size(),d=()=>{let g=JSON.parse(JSON.stringify(s.lastTransform())),y=s.duration();n&&s.fit();let{svg:w}=s.getChartState();setTimeout(_=>{s.downloadImage({node:w.node(),scale:t,isSvg:!1,backgroundColor:o,onAlreadySerialized:k=>{s.update(l)},imageName:a.imageName,onLoad:r,save:i})},n?y+10:0)};p>0?h.each(function(){s.toDataURL(this.src,g=>{this.src=g,++c==p&&d()})}):d()}exportSvg(){let{svg:n,imageName:t}=this.getChartState();return this.downloadImage({imageName:t,node:n.node(),scale:3,isSvg:!0}),this}expandAll(){let{allNodes:n,root:t,data:r}=this.getChartState();return r.forEach(i=>i._expanded=!0),this.render(),this}collapseAll(){let{allNodes:n,root:t}=this.getChartState();return n.forEach(r=>r.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:n,scale:t=2,imageName:r="graph",isSvg:i=!1,save:o=!0,backgroundColor:s="#FAFAFA",onAlreadySerialized:a=l=>{},onLoad:u=l=>{}}){let l=n;function c(y,w){var _=document.createElement("a");typeof _.download=="string"?(document.body.appendChild(_),_.download=w,_.href=y,_.click(),document.body.removeChild(_)):location.replace(y)}function h(y){let w="http://www.w3.org/2000/xmlns/",_="http://www.w3.org/1999/xlink",k="http://www.w3.org/2000/svg";y=y.cloneNode(!0);let M=window.location.href+"#",T=document.createTreeWalker(y,NodeFilter.SHOW_ELEMENT,null,!1);for(;T.nextNode();)for(let Y of T.currentNode.attributes)Y.value.includes(M)&&(Y.value=Y.value.replace(M,"#"));return y.setAttributeNS(w,"xmlns",k),y.setAttributeNS(w,"xmlns:xlink",_),new XMLSerializer().serializeToString(y)}if(i){let y=h(l);y=`<?xml version="1.0" standalone="no"?>\r
`+y;var g="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(y);c(g,r+".svg"),a();return}let p=t,d=document.createElement("img");d.onload=function(){let y=document.createElement("canvas"),w=l.getBoundingClientRect();y.width=w.width*p,y.height=w.height*p;let _=y.getContext("2d");_.fillStyle=s,_.fillRect(0,0,w.width*p,w.height*p),_.drawImage(d,0,0,w.width*p,w.height*p);let k=y.toDataURL("image/png");u&&u(k),o&&c(k,r+".png")};var g="data:image/svg+xml; charset=utf8, "+encodeURIComponent(h(l));a(),d.src=g}getTextWidth(n,{fontSize:t=14,fontWeight:r=400,defaultFont:i="Helvetice",ctx:o}={}){return o.font=`${r||""} ${t}px ${i} `,o.measureText(n).width}clear(){let n=this.getChartState();N.select(window).on(`resize.${n.id}`,null),n.svg&&n.svg.selectAll("*").remove()}};export{Il as a,Al as b,yo as c};
