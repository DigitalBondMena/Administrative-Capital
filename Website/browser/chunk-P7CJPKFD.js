import{a as $}from"./chunk-MUTUDFVP.js";import{h as H,i as J}from"./chunk-VVREEA4Z.js";import"./chunk-VETFLQVH.js";import{c as A,g as q,k as z,w as G}from"./chunk-XW6HRBBI.js";import{a as K}from"./chunk-5PIXQBFG.js";import"./chunk-ICJAHFYR.js";import{a as W}from"./chunk-DUBUWPD2.js";import"./chunk-PBA57O2B.js";import"./chunk-NPMQALXN.js";import"./chunk-DNPQSKTC.js";import{D as U,c as N,h as j,i as D,j as R}from"./chunk-TNPE2B44.js";import{$b as F,Ab as k,Eb as v,Ib as h,Jb as f,Rb as l,Tb as b,Va as s,Vb as y,Wa as c,Wb as M,Xb as I,Zb as E,_b as T,ac as O,ea as w,fc as C,gc as V,ic as L,lb as _,na as g,oa as u,pb as d,ub as S,vb as x,wb as B,xb as P,yb as r,zb as n}from"./chunk-MFMNMFCO.js";import"./chunk-DM275RSA.js";var Q=()=>[8,16,32],X=t=>["/protocols/sop-details/",t],Y=(t,a)=>({"border-bottom":t,"border-end":a});function Z(t,a){t&1&&(r(0,"div",7)(1,"div",12)(2,"p",13),l(3,"No SOPs Found"),n()()())}function ee(t,a){if(t&1){let e=v();r(0,"div",9),k(1,"img",14),r(2,"p",15),l(3),n(),r(4,"p",16),l(5,"created at:"),n(),r(6,"p",17),l(7),C(8,"date"),n(),r(9,"button",18),h("click",function(i){let m=g(e).$implicit,p=f(2);return u(p.removeBookmark(m.id,i))}),k(10,"i",19),n()()}if(t&2){let e=a.$implicit,o=a.$index;d("routerLink",F(7,X,e.sop.title_slug))("ngClass",O(9,Y,o<4,o!==3&&o!==7)),s(),d("alt",e.sop.title),s(2),b(" ",e.sop.title," "),s(4),b(" ",V(8,5,e.created_at)," ")}}function te(t,a){if(t&1){let e=v();_(0,Z,4,0,"div",7),r(1,"div",8),B(2,ee,11,12,"div",9,x),C(4,"slice"),n(),r(5,"div",10)(6,"p-paginator",11),h("onPageChange",function(i){g(e);let m=f();return u(m.onPageChange(i))}),n()()}if(t&2){let e=f();S(0,e.filteredBookmarks.length===0?0:-1),s(2),P(L(4,5,e.filteredBookmarks,e.first,e.next)),s(4),d("first",e.first)("rows",e.rows)("totalRecords",e.filteredBookmarks.length)("rowsPerPageOptions",T(9,Q))}}function oe(t,a){t&1&&(r(0,"div",7)(1,"div",12)(2,"p",13),l(3,"No SOPs Found"),n()()())}var he=(()=>{class t{constructor(e,o,i){this.sopService=e,this.bookmarkService=o,this.toastrService=i,this.bookmarks=[],this.filteredBookmarks=[],this.inputSearch="",this.first=0,this.rows=8,this.next=8}ngOnInit(){this.getSopBookmarks()}getUserId(){return localStorage.getItem("userId")||""}getSopBookmarks(){this.sopService.getUserBookmarksSop().subscribe({next:e=>{this.bookmarks=e.bookmarks,this.filterBookmarks()},error:e=>{console.error("Error fetching SOP bookmarks:",e),this.toastrService.error("Failed to load bookmarks")}})}filterBookmarks(){if(!this.inputSearch.trim())this.filteredBookmarks=[...this.bookmarks];else{let e=this.inputSearch.toLowerCase();this.filteredBookmarks=this.bookmarks.filter(o=>o.sop.title.toLowerCase().includes(e))}this.first>=this.filteredBookmarks.length?(this.first=0,this.next=Math.min(this.rows,this.filteredBookmarks.length)):this.next=Math.min(this.first+this.rows,this.filteredBookmarks.length)}removeBookmark(e,o){o.stopPropagation();let i={user_id:+this.getUserId(),bookmark_id:e};this.bookmarkService.deleteBookmark(i).subscribe({next:()=>{this.toastrService.success("Bookmark removed"),this.getSopBookmarks()},error:m=>{console.error("Error removing bookmark:",m),this.toastrService.error("Failed to remove bookmark")}})}onPageChange(e){this.first=e.first,this.rows=e.rows,this.next=Math.min(this.first+this.rows,this.filteredBookmarks.length)}onSearchInput(){this.filterBookmarks()}static{this.\u0275fac=function(o){return new(o||t)(c($),c(K),c(W))}}static{this.\u0275cmp=w({type:t,selectors:[["app-sop-bookmarks"]],standalone:!0,features:[E],decls:10,vars:2,consts:[[1,"container-fluid"],[1,"py-5"],[1,"row","g-0"],[1,"col-12","shadow","w-100","mb-4","bg-secondary","p-5"],[1,"form-floating","mb-3"],["type","search","id","floatingInput","placeholder","search SOPs...",1,"form-control",3,"ngModelChange","ngModel"],["for","floatingInput"],[1,"card","border-0","bg-light","shadow-sm","position-relative","card__animation"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-3","row-cols-lg-4","min-h-40vh"],[1,"text-center","bg-light","p-5","Protocol__Card","position-relative","card__animation",3,"routerLink","ngClass"],[1,"flex","justify-content-center"],[3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],[1,"card-title","p-3","pb-0","fs-4"],[1,"fw-semibold"],["src","./assets/app_logo.webp",1,"w-85","mx-auto","mb-3",3,"alt"],[1,"fs-6","text-secondary","fw-bold"],[1,"text-dark","text-opacity-50","text-center","mb-0"],[1,"text-dark","text-opacity-50","text-center"],["pTooltip","remove bookmark","tooltipPosition","top",1,"w-45","position-absolute","top-0","start-0","m-3","btn","text-secondary",3,"click"],[1,"fa-solid","fa-bookmark","fs-4"]],template:function(o,i){o&1&&(r(0,"div",0)(1,"section",1),k(2,"div",2),r(3,"div",3)(4,"div",4)(5,"input",5),I("ngModelChange",function(p){return M(i.inputSearch,p)||(i.inputSearch=p),p}),h("ngModelChange",function(){return i.onSearchInput()}),n(),r(6,"label",6),l(7,"Search SOPs"),n()()(),_(8,te,7,10)(9,oe,4,0),n()()),o&2&&(s(5),y("ngModel",i.inputSearch),s(3),S(8,i.bookmarks.length>0?8:9))},dependencies:[R,N,D,j,G,A,q,z,J,H,U]})}}return t})();export{he as SopBookmarksComponent};
