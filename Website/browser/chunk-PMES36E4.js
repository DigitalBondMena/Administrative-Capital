import{a as se,b as ie}from"./chunk-WTGH7RYH.js";import{a as te}from"./chunk-LGNMUVHS.js";import{h as Z,i as ee}from"./chunk-VVREEA4Z.js";import"./chunk-VETFLQVH.js";import{c as $,e as A,g as H,h as J,l as W,n as z,o as K,v as U,x as X}from"./chunk-XW6HRBBI.js";import"./chunk-ICJAHFYR.js";import"./chunk-PBA57O2B.js";import"./chunk-NPMQALXN.js";import"./chunk-DNPQSKTC.js";import{A as Y,D as G,h as k,i as O}from"./chunk-TNPE2B44.js";import{$ as y,$b as b,Ab as c,Eb as S,Ib as x,Jb as l,Nb as I,Ob as P,Pb as q,Qb as M,Rb as r,Sb as d,Tb as R,Va as s,Wa as D,Zb as V,_b as T,db as Q,ea as j,fc as g,gc as L,hc as B,ic as N,lb as h,na as f,oa as _,pb as p,tb as v,ub as w,wb as F,xb as E,yb as n,zb as o}from"./chunk-MFMNMFCO.js";import{f as oe}from"./chunk-DM275RSA.js";var C=oe(se());var re=["successModal"],ae=(i,m)=>m.id,ne=i=>({"d-none":i}),me=i=>["/community/questions",i],le=()=>[5,10,30];function ue(i,m){i&1&&(n(0,"div",11),r(1," Answer is required and must be at least 3 characters. "),o())}function ce(i,m){if(i&1){let t=S();n(0,"button",27),x("click",function(){f(t);let a=l().$implicit,u=l(2);return _(u.alertConfirmDelete(a.id))}),r(1," Remove "),c(2,"i",28),o()}}function de(i,m){if(i&1&&(n(0,"li",20)(1,"p",24),r(2),o(),n(3,"div",25)(4,"small",4),r(5," \u{1F464} "),n(6,"strong"),r(7),o(),r(8," \u2022 "),n(9,"span"),r(10),g(11,"date"),o()(),h(12,ce,3,0,"button",26),o()()),i&2){let t=m.$implicit,e=l(2);s(2),d(t.community_answer_text),s(5),d(t.userdata.name),s(3),d(B(11,4,t.created_at,"yyyy-MMMM-dd hh:mm a")),s(2),w(12,t.userdata.email===e.userEmail||e.userRole==="admin"?12:-1)}}function pe(i,m){i&1&&(n(0,"div",21)(1,"p",29),r(2,"No Answers yet!"),o()())}function fe(i,m){if(i&1){let t=S();n(0,"div",2)(1,"h3",3),r(2),o(),n(3,"p",4),r(4),o()(),n(5,"div",5)(6,"h5",6),r(7,"\u{1F4DD} Post Your Answer"),o(),n(8,"form",7),x("ngSubmit",function(){f(t);let a=l();return _(a.submitQuestion())}),c(9,"textarea",8,0),n(11,"div",9)(12,"span",10),r(13),o()(),h(14,ue,2,0,"div",11),n(15,"button",12),r(16," Submit Answer "),c(17,"i",13)(18,"i",14),o()()(),n(19,"div",15)(20,"a",16),c(21,"i",17),r(22," Back to Questions "),o()(),n(23,"div",18)(24,"h5",6),r(25,"\u2705 Answers"),o(),n(26,"div")(27,"ul",19),F(28,de,13,7,"li",20,ae,!1,pe,3,0,"div",21),g(31,"reverse"),g(32,"slice"),o()()(),n(33,"div",22)(34,"p-paginator",23),x("onPageChange",function(a){f(t);let u=l();return _(u.onPageChange(a))}),o()()}if(i&2){let t=M(10),e=l();s(2),R(" \u{1F539} ",e.subjectQuestionAnswers.subject.helper_title," "),s(2),d(e.subjectQuestionAnswers.subject.helper_text),s(4),p("formGroup",e.questionForm),s(5),d(t.value.length),s(),w(14,e.questionForm.controls.community_answer_text.invalid&&e.questionForm.controls.community_answer_text.touched?14:-1),s(),p("disabled",e.isLoading),s(2),v(b(22,ne,e.isLoading)),s(),v(b(24,ne,!e.isLoading)),s(2),p("routerLink",b(26,me,e.subjectQuestionAnswers.subject.community_subject_id)),s(8),E(N(32,18,L(31,16,e.subjectQuestionAnswers.subject.answers),e.first,e.next)),s(6),p("first",e.first)("rows",e.rows)("totalRecords",e.subjectQuestionAnswers.subject.answers.length)("rowsPerPageOptions",T(28,le))}}function _e(i,m){i&1&&(n(0,"div",21)(1,"p",29),r(2," Loading Data... "),c(3,"i",30),o()())}var Fe=(()=>{class i{constructor(t){this.fb=t,this.inputSearch="",this.communityServices=y(te),this.activatedRoute=y(Y),this.first=0,this.rows=5,this.next=5,this.isLoading=!1,Q(()=>{let e=JSON.parse(localStorage.getItem("userDetails"));this.userEmail=e.email,this.userRole=e.role,this.userID=e.id,console.log(e.role),console.log(e.email),console.log(e.id)})}ngOnInit(){this.getCurrentSubjectId(),this.questionForm=this.fb.group({user_id:[this.userID],community_answer_title:[""],community_answer_text:["",[A.required,A.minLength(3)]]})}getCurrentSubjectId(){this.activatedRoute.paramMap.subscribe({next:t=>{this.currentId=t.get("id"),this.getSubjectQuestions()}})}getSubjectQuestions(){this.communityServices.getCommunityHelp(this.currentId).subscribe({next:t=>{console.log(t),this.subjectQuestionAnswers=t}})}onPageChange(t){this.first=t.first,this.rows=t.rows,t.first+t.rows<this.subjectQuestionAnswers.subject.answers.length?(this.first=t.first,this.rows=t.rows,this.next=this.first+t.rows):this.next=this.subjectQuestionAnswers.subject.answers.length}alertConfirmDelete(t){C.default.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(e=>{e.isConfirmed&&this.deleteQuestion(t)})}deleteQuestion(t){this.communityServices.deleteCommunityAnswer(t).subscribe({next:e=>{console.log(e),this.getSubjectQuestions(),this.deleteQuestionSwal()}})}deleteQuestionSwal(){C.default.fire({title:"Deleted!",text:"Your answer has been deleted.",icon:"success"})}submitQuestion(){this.questionForm.valid&&(this.isLoading=!0,this.questionForm.get("user_id")?.setValue(this.userID),this.communityServices.StoreCommunityAnswer(this.currentId,this.questionForm.value).subscribe({next:t=>{this.isLoading=!1,console.log(t),this.getSubjectQuestions(),this.questionForm.reset(),this.successAddQuestion()}}))}successAddQuestion(){C.default.fire({title:"Answer Added",text:"Your answer has been Added Successfully.",icon:"success"})}static{this.\u0275fac=function(e){return new(e||i)(D(U))}}static{this.\u0275cmp=j({type:i,selectors:[["app-answers-community"]],viewQuery:function(e,a){if(e&1&&I(re,5),e&2){let u;P(u=q())&&(a.successModal=u.first)}},standalone:!0,features:[V],decls:3,vars:1,consts:[["text",""],[1,"container","my-5","py-5","min-h-50vh"],[1,"mb-4"],[1,"fw-bold"],[1,"text-muted"],[1,"mt-5","p-4","bg-light","rounded","shadow-sm"],[1,"fw-bold","mb-3"],[3,"ngSubmit","formGroup"],["rows","5","placeholder","Write your answer here...","formControlName","community_answer_text",1,"form-control","mb-2"],[1,"text-end"],[1,"text-muted","small"],[1,"text-danger","mb-2"],[1,"btn","btn-success",3,"disabled"],[1,"fa-solid","fa-plus","ms-1"],[1,"fa-solid","fa-spin","fa-spinner","ms-1"],[1,"text-end","mt-4"],[1,"btn","btn-secondary",3,"routerLink"],[1,"fa-solid","fa-arrow-left-long","me-2"],[1,"mt-4"],[1,"list-group"],[1,"list-group-item","p-3","shadow-sm","rounded","mb-3","height-250","d-flex","flex-column","justify-content-between"],[1,"card","border-0","bg-light","shadow-sm","text-center","p-4"],[1,"d-flex","justify-content-center","mt-4"],[3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions"],[1,"mb-2"],[1,"d-flex","justify-content-between","flex-column","flex-md-row"],[1,"btn","btn-sm","btn-outline-danger"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fa-solid","fa-trash"],[1,"fw-semibold"],[1,"fa-solid","fa-spin","fa-spinner"]],template:function(e,a){e&1&&(n(0,"div",1),h(1,fe,35,29)(2,_e,4,0),o()),e&2&&(s(),w(1,a.subjectQuestionAnswers?1:2))},dependencies:[ee,Z,W,$,H,J,k,G,X,z,K,O,ie],styles:[".height-250[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}"]})}}return i})();export{Fe as AnswersCommunityComponent};
